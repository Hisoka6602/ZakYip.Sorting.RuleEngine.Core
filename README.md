# ZakYip.Sorting.RuleEngine

## é¡¹ç›®ç®€ä»‹

ZakYipåˆ†æ‹£è§„åˆ™å¼•æ“ç³»ç»Ÿæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„åŒ…è£¹åˆ†æ‹£è§„åˆ™å¼•æ“ï¼Œç”¨äºå¤„ç†åˆ†æ‹£ç¨‹åºçš„åŒ…è£¹ä¿¡æ¯å’ŒDWSï¼ˆå°ºå¯¸é‡é‡æ‰«æï¼‰æ•°æ®ï¼Œé€šè¿‡è‡ªå®šä¹‰è§„åˆ™åˆ†æè®¡ç®—æ ¼å£å·ï¼Œå®ç°è‡ªåŠ¨åŒ–åˆ†æ‹£ã€‚

## æœ€æ–°æ›´æ–°

### v1.11.0 (2025-11-04)
- âœ… **å®Œæ•´æ•°æ®åº“é™çº§è¿˜åŸé€»è¾‘** - å¢å¼ºæ•°æ®åº“ç†”æ–­å™¨çš„è‡ªåŠ¨æ¢å¤åŠŸèƒ½
  - MySQLæ¢å¤åè‡ªåŠ¨åŒæ­¥SQLiteæ‰€æœ‰æ•°æ®åˆ°MySQLï¼ˆä¹‹å‰ä»…åŒæ­¥LogEntryè¡¨ï¼‰
  - æ–°å¢æ”¯æŒè¡¨ï¼šCommunicationLogã€SorterCommunicationLogã€DwsCommunicationLogã€ApiCommunicationLogã€MatchingLogã€ApiRequestLog
  - åŒæ­¥å®Œæˆåè‡ªåŠ¨æ¸…ç©ºSQLiteæ‰€æœ‰è¡¨æ•°æ®
  - æ‰§è¡ŒVACUUMå‘½ä»¤å‹ç¼©SQLiteç£ç›˜ç©ºé—´ï¼Œé‡Šæ”¾å·²åˆ é™¤æ•°æ®å ç”¨çš„ç©ºé—´
  - é˜²æ­¢SQLiteæ•°æ®åº“æ–‡ä»¶æŒç»­å¢é•¿
  - ç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼Œæ— æ•°æ®ä¸¢å¤±

### v1.10.0 (2025-10-25)
- âœ… **æ•°æ®åº“è¿ç§»é‡ç½®** - æ¸…ç©ºå¹¶é‡æ–°ç”Ÿæˆæ‰€æœ‰æ•°æ®åº“è¿ç§»
  - åˆ é™¤æ‰€æœ‰å†å²è¿ç§»æ–‡ä»¶ï¼Œç®€åŒ–è¿ç§»å†å²
  - é‡æ–°ç”ŸæˆMySQLåˆå§‹è¿ç§» (20251025042050_InitialCreate)
  - é‡æ–°ç”ŸæˆSQLiteåˆå§‹è¿ç§» (20251025042107_InitialCreate)
  - æ–°è¿ç§»åŒ…å«æ‰€æœ‰ç°æœ‰æ•°æ®åº“æ¶æ„ï¼ˆæ ¼å£ã€ä¸“ç”¨æ—¥å¿—è¡¨ã€æ€§èƒ½æŒ‡æ ‡ç­‰ï¼‰
  - æ„å»ºæˆåŠŸï¼Œæ‰€æœ‰æµ‹è¯•é€šè¿‡
  - ç®€åŒ–éƒ¨ç½²æµç¨‹ï¼Œç»Ÿä¸€åˆå§‹æ•°æ®åº“ç»“æ„

## æ ¸å¿ƒç‰¹æ€§

- âœ… **WindowsæœåŠ¡** - ä½œä¸ºWindowsæœåŠ¡è¿è¡Œï¼Œç¨³å®šå¯é 
- âœ… **MiniAPIé›†æˆ** - å†…ç½®Web APIç”¨äºå‰ç«¯é…ç½®å’Œäº¤äº’
- âœ… **äº‹ä»¶é©±åŠ¨æ¶æ„** - ä½¿ç”¨MediatRå®ç°äº‹ä»¶é©±åŠ¨ï¼Œæ”¯æŒåˆ†æ‹£ç¨‹åºä¿¡å·æ¥æ”¶å’ŒFIFOé˜Ÿåˆ—å¤„ç†
- âœ… **æ•°æ®åˆ†ç‰‡** - ä½¿ç”¨EFCore.Shardingå®ç°æ—¶é—´ç»´åº¦åˆ†è¡¨ï¼Œæ”¯æŒçƒ­å†·æ•°æ®åˆ†ç¦»
- âœ… **é«˜æ€§èƒ½è®¾è®¡** - ä½¿ç”¨HTTPå®¢æˆ·ç«¯æ± åŒ–ã€å¯é…ç½®ç¼“å­˜ï¼ˆç»å¯¹/æ»‘åŠ¨è¿‡æœŸï¼‰ã€å¼‚æ­¥å¤„ç†ç­‰æŠ€æœ¯ï¼Œé€‚åˆé«˜é¢‘ç‡åœºæ™¯ï¼ˆ50æ¬¡/ç§’ï¼‰
- âœ… **å¤šæ•°æ®åº“æ”¯æŒ** - LiteDBå­˜å‚¨é…ç½®ï¼ŒMySQLè®°å½•æ—¥å¿—ï¼ŒSQLiteä½œä¸ºé™çº§æ–¹æ¡ˆï¼Œæ”¯æŒEF Coreè‡ªåŠ¨è¿ç§»ï¼Œä¼˜åŒ–ç´¢å¼•å’Œé™åºæ’åº
- âœ… **å¼¹æ€§æ¶æ„** - æ•°æ®åº“ç†”æ–­å™¨ï¼ˆå¯é…ç½®å¤±è´¥ç‡ã€ç†”æ–­æ—¶é•¿ï¼‰ï¼Œè‡ªåŠ¨é™çº§å’Œå®Œæ•´æ•°æ®åŒæ­¥ï¼Œé˜²æ­¢ç³»ç»Ÿé›ªå´©
  - MySQLå¤±è´¥æ—¶è‡ªåŠ¨é™çº§åˆ°SQLiteå­˜å‚¨æ‰€æœ‰æ—¥å¿—æ•°æ®
  - MySQLæ¢å¤åè‡ªåŠ¨å°†SQLiteæ‰€æœ‰è¡¨æ•°æ®å›å¡«åˆ°MySQL
  - è‡ªåŠ¨æ¸…ç©ºSQLiteæ•°æ®å¹¶æ‰§è¡ŒVACUUMå‹ç¼©ç£ç›˜ç©ºé—´
  - æ”¯æŒ7ç§æ—¥å¿—è¡¨å®Œæ•´åŒæ­¥ï¼šLogEntryã€CommunicationLogã€SorterCommunicationLogã€DwsCommunicationLogã€ApiCommunicationLogã€MatchingLogã€ApiRequestLog
- âœ… **è‡ªåŠ¨æ•°æ®ç®¡ç†** - å¯é…ç½®çš„æ•°æ®æ¸…ç†ï¼ˆé»˜è®¤90å¤©ï¼‰å’Œå½’æ¡£æœåŠ¡ï¼Œè‡ªåŠ¨ç»´æŠ¤æ•°æ®ç”Ÿå‘½å‘¨æœŸ
- âœ… **MySQLè‡ªåŠ¨è°ƒè°** - æ€§èƒ½ç›‘æ§ã€ç´¢å¼•åˆ†æã€è¿æ¥æ± ä¼˜åŒ–å’Œæ…¢æŸ¥è¯¢è¯†åˆ«
- âœ… **å¤šåè®®æ”¯æŒ** - æ”¯æŒTCP/SignalRç­‰å¤šç§åè®®ï¼Œé€šè¿‡é€‚é…å™¨æ¨¡å¼æ‰©å±•å¤šå‚å•†å¯¹æ¥
- âœ… **SignalR Hub** - æä¾›SortingHubå’ŒDwsHubå®ç°å®æ—¶åŒå‘é€šä¿¡ï¼Œç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨
- âœ… **çƒ­åˆ‡æ¢æ”¯æŒ** - é€‚é…å™¨ç®¡ç†å™¨æ”¯æŒè¿è¡Œæ—¶çƒ­åˆ‡æ¢ï¼Œæ— éœ€é‡å¯æœåŠ¡å³å¯åˆ‡æ¢DWS/åˆ†æ‹£æœºé€‚é…å™¨
- âœ… **TouchSocketä¼˜åŒ–** - ä½¿ç”¨TouchSocketåº“å®ç°é«˜æ€§èƒ½TCPé€šä¿¡ï¼Œæ”¯æŒè¿æ¥æ± å’Œè‡ªåŠ¨é‡è¿
- âœ… **é€šä¿¡æ—¥å¿—** - å…¨é‡è®°å½•TCP/SignalR/HTTPé€šä¿¡æ—¥å¿—ï¼Œæ”¯æŒé—®é¢˜è¿½è¸ªå’Œè°ƒè¯•
- âœ… **æµ‹è¯•å·¥å…·** - æä¾›åˆ†æ‹£æœºä¿¡å·æ¨¡æ‹Ÿæµ‹è¯•æ§åˆ¶å°ï¼Œä¾¿äºå¼€å‘å’Œæµ‹è¯•
- âœ… **è‡ªåŠ¨è¿ç§»** - EF Coreè‡ªåŠ¨åº”ç”¨æ•°æ®åº“è¿ç§»ï¼Œéƒ¨ç½²æ—¶è‡ªåŠ¨åˆ›å»ºè¡¨å’Œç´¢å¼•
- âœ… **æ¸…æ™°æ¶æ„** - é‡‡ç”¨DDDåˆ†å±‚æ¶æ„ï¼Œæ‰€æœ‰ç±»ã€æšä¸¾ã€äº‹ä»¶ç‹¬ç«‹æ–‡ä»¶å­˜æ”¾
- âœ… **ä¸­å¤®åŒ…ç®¡ç†** - ä½¿ç”¨Directory.Packages.propsç»Ÿä¸€ç®¡ç†NuGetåŒ…ç‰ˆæœ¬
- âœ… **å®Œæ•´æµ‹è¯•** - å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒåŠŸèƒ½
- âœ… **ä¸­æ–‡æ³¨é‡Š** - æ ¸å¿ƒä»£ç ä½¿ç”¨ä¸­æ–‡æ³¨é‡Š
- âœ… **æ€§èƒ½ç›‘æ§** - å…¨é¢çš„æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œç›‘æ§ï¼ˆv1.5.0æ–°å¢ï¼‰
- âœ… **å¤šç§åŒ¹é…æ–¹æ³•** - æ”¯æŒ6ç§åŒ¹é…æ–¹æ³•ï¼šæ¡ç æ­£åˆ™ã€é‡é‡ã€ä½“ç§¯ã€OCRã€APIå“åº”ã€ä½ä»£ç è¡¨è¾¾å¼ï¼ˆv1.5.0æ–°å¢ï¼‰
- âœ… **å¤šè§„åˆ™åŒ¹é…** - ä¸€ä¸ªæ ¼å£å¯åŒ¹é…å¤šæ¡è§„åˆ™ï¼ŒæŒ‰ä¼˜å…ˆçº§é€‰æ‹©ï¼ˆv1.5.0æ–°å¢ï¼‰

## å·²å®ç°åŠŸèƒ½æ€»è§ˆ (æˆªè‡³ v1.11.0)

### æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½
- âœ… **åŒ…è£¹åˆ†æ‹£æµç¨‹** - å®Œæ•´çš„åŒ…è£¹åˆ›å»ºã€DWSæ•°æ®æ¥æ”¶ã€è§„åˆ™åŒ¹é…ã€æ ¼å£åˆ†é…æµç¨‹
- âœ… **è§„åˆ™å¼•æ“** - æ”¯æŒ6ç§åŒ¹é…æ–¹æ³•ï¼ˆæ¡ç æ­£åˆ™ã€é‡é‡ã€ä½“ç§¯ã€OCRã€APIå“åº”ã€ä½ä»£ç è¡¨è¾¾å¼ï¼‰
- âœ… **å¤šè§„åˆ™åŒ¹é…** - ä¸€ä¸ªæ ¼å£æ”¯æŒå¤šæ¡è§„åˆ™ï¼ŒæŒ‰ä¼˜å…ˆçº§è‡ªåŠ¨é€‰æ‹©æœ€ä½³è§„åˆ™
- âœ… **è§„åˆ™å®‰å…¨éªŒè¯** - é˜²æ­¢ä»£ç æ³¨å…¥ï¼ŒéªŒè¯è¡¨è¾¾å¼å®‰å…¨æ€§
- âœ… **æ ¼å£ç®¡ç†** - å®Œæ•´çš„æ ¼å£CRUDæ“ä½œï¼Œæ”¯æŒå¯ç”¨/ç¦ç”¨çŠ¶æ€ç®¡ç†
- âœ… **ç¬¬ä¸‰æ–¹APIé›†æˆ** - æ”¯æŒå¤šä¸ªç¬¬ä¸‰æ–¹APIé…ç½®ï¼Œå¯é…ç½®ä¼˜å…ˆçº§å’Œè¶…æ—¶

### é€šä¿¡ä¸åè®®
- âœ… **SignalRå®æ—¶é€šä¿¡** - æä¾›SortingHubå’ŒDwsHubï¼Œæ”¯æŒåŒå‘é€šä¿¡å’Œè‡ªåŠ¨é‡è¿
- âœ… **TCPé€šä¿¡** - åŸºäºTouchSocketçš„é«˜æ€§èƒ½TCPé€šä¿¡ï¼Œæ”¯æŒè¿æ¥æ± å’Œè‡ªåŠ¨é‡è¿
- âœ… **HTTP API** - å®Œæ•´çš„REST APIï¼Œæ”¯æŒåŒ…è£¹å¤„ç†ã€è§„åˆ™ç®¡ç†ã€æ—¥å¿—æŸ¥è¯¢ç­‰
- âœ… **é€‚é…å™¨æ¨¡å¼** - æ”¯æŒå¤šå‚å•†è®¾å¤‡å¯¹æ¥ï¼Œè¿è¡Œæ—¶çƒ­åˆ‡æ¢æ— éœ€é‡å¯
- âœ… **é€šä¿¡æ—¥å¿—** - å…¨é‡è®°å½•æ‰€æœ‰TCP/SignalR/HTTPé€šä¿¡ï¼Œæ”¯æŒé—®é¢˜è¿½è¸ª

### æ•°æ®æŒä¹…åŒ–
- âœ… **å¤šæ•°æ®åº“æ”¯æŒ** - LiteDBï¼ˆé…ç½®ï¼‰ã€MySQLï¼ˆæ—¥å¿—ï¼‰ã€SQLiteï¼ˆé™çº§ï¼‰
- âœ… **EF Coreè‡ªåŠ¨è¿ç§»** - éƒ¨ç½²æ—¶è‡ªåŠ¨åˆ›å»º/æ›´æ–°æ•°æ®åº“ç»“æ„
- âœ… **æ•°æ®åˆ†ç‰‡** - åŸºäºæ—¶é—´ç»´åº¦çš„è¡¨åˆ†åŒºï¼ˆæ—¥/å‘¨/æœˆï¼‰ï¼Œæ”¯æŒçƒ­å†·æ•°æ®åˆ†ç¦»
- âœ… **ä¸“ç”¨æ—¥å¿—è¡¨** - åˆ†æ‹£æœºé€šä¿¡æ—¥å¿—ã€DWSé€šä¿¡æ—¥å¿—ã€APIé€šä¿¡æ—¥å¿—ã€åŒ¹é…æ—¥å¿—ã€APIè¯·æ±‚æ—¥å¿—
- âœ… **è‡ªåŠ¨æ•°æ®æ¸…ç†** - åŸºäºç©ºé—²ç­–ç•¥çš„æ•°æ®æ¸…ç†ï¼ˆé»˜è®¤90å¤©ä¿ç•™æœŸï¼‰
- âœ… **æ•°æ®å½’æ¡£** - è‡ªåŠ¨å½’æ¡£å†·æ•°æ®ï¼ˆé»˜è®¤30å¤©é˜ˆå€¼ï¼‰
- âœ… **å®Œæ•´æ•°æ®åŒæ­¥** - MySQLæ¢å¤åè‡ªåŠ¨å›å¡«SQLiteæ‰€æœ‰è¡¨æ•°æ®å¹¶å‹ç¼©ç£ç›˜

### æ€§èƒ½ä¸å¼¹æ€§
- âœ… **é«˜æ€§èƒ½è®¾è®¡** - å¯¹è±¡æ± ã€å†…å­˜ç¼“å­˜ã€å¼‚æ­¥å¤„ç†ã€æ‰¹é‡å¤„ç†
- âœ… **ç¼“å­˜ç­–ç•¥** - å¯é…ç½®çš„ç»å¯¹/æ»‘åŠ¨è¿‡æœŸæ—¶é—´
- âœ… **æ•°æ®åº“ç†”æ–­å™¨** - MySQLå¤±è´¥è‡ªåŠ¨é™çº§åˆ°SQLiteï¼Œæ¢å¤åè‡ªåŠ¨åŒæ­¥7ç§æ—¥å¿—è¡¨
- âœ… **HTTPå®¢æˆ·ç«¯æ± åŒ–** - é¿å…ç«¯å£è€—å°½
- âœ… **æ€§èƒ½ç›‘æ§** - P50/P95/P99å»¶è¿Ÿç»Ÿè®¡ï¼Œè§„åˆ™è¯„ä¼°ã€APIè°ƒç”¨ã€æ•°æ®åº“æ“ä½œæ—¶é•¿è¿½è¸ª
- âœ… **æ€§èƒ½åŸºå‡†æµ‹è¯•** - åŸºäºBenchmarkDotNetçš„å®Œæ•´æ€§èƒ½æµ‹è¯•é¡¹ç›®
- âœ… **MySQLè‡ªåŠ¨è°ƒè°** - è¡¨ç»Ÿè®¡åˆ†æã€ç´¢å¼•ä½¿ç”¨åˆ†æã€è¿æ¥æ± ç›‘æ§ã€æ…¢æŸ¥è¯¢è¯†åˆ«

### ç›‘æ§ä¸æ—¥å¿—
- âœ… **NLogæ—¥å¿—æ¡†æ¶** - å¤šç›®æ ‡æ—¥å¿—ï¼ˆæ§åˆ¶å°ã€æ–‡ä»¶ã€é”™è¯¯ã€æ€§èƒ½ï¼‰ï¼Œè‡ªåŠ¨è½®è½¬å½’æ¡£
- âœ… **é€šä¿¡æ—¥å¿—è®°å½•** - è®°å½•æ‰€æœ‰é€šä¿¡ç»†èŠ‚ï¼ŒåŒ…æ‹¬åŸå§‹å†…å®¹ã€æ ¼å¼åŒ–å†…å®¹ã€æ—¶é—´æˆ³
- âœ… **APIè¯·æ±‚æ—¥å¿—** - è®°å½•æ‰€æœ‰HTTPè¯·æ±‚/å“åº”ï¼ŒåŒ…æ‹¬è€—æ—¶ã€çŠ¶æ€ç ã€IPåœ°å€
- âœ… **æ€§èƒ½æŒ‡æ ‡æ”¶é›†** - è‡ªåŠ¨æ”¶é›†å’Œç»Ÿè®¡å„ç±»æ“ä½œçš„æ€§èƒ½æŒ‡æ ‡
- âœ… **æ—¥å¿—æŸ¥è¯¢API** - æ”¯æŒæŒ‰æ—¶é—´ã€åŒ…è£¹IDã€ç±»å‹ç­‰æ¡ä»¶æŸ¥è¯¢å’Œå¯¼å‡ºæ—¥å¿—
- âœ… **ç”˜ç‰¹å›¾æ•°æ®API** - æŸ¥è¯¢æŒ‡å®šåŒ…è£¹å‰åNæ¡æ•°æ®ï¼Œæ”¯æŒæ—¶é—´çº¿å¯è§†åŒ–

### å¼€å‘ä¸æµ‹è¯•
- âœ… **å•å…ƒæµ‹è¯•** - 182ä¸ªå•å…ƒæµ‹è¯•ï¼Œè¦†ç›–æ ¸å¿ƒåŠŸèƒ½
- âœ… **æ€§èƒ½åŸºå‡†æµ‹è¯•** - è§„åˆ™åŒ¹é…æ€§èƒ½æµ‹è¯•ï¼ˆæ¡ç ã€é‡é‡ã€ä½“ç§¯ï¼‰
- âœ… **æµ‹è¯•æ§åˆ¶å°** - æ¨¡æ‹Ÿåˆ†æ‹£æœºä¿¡å·å’ŒDWSæ•°æ®å‘é€
- âœ… **Swaggeræ–‡æ¡£** - è‡ªåŠ¨ç”Ÿæˆçš„APIæ–‡æ¡£
- âœ… **å…¨å±€æ¨¡å‹éªŒè¯** - è‡ªåŠ¨éªŒè¯æ‰€æœ‰APIè¯·æ±‚å‚æ•°

### æ¶æ„ä¸ä»£ç è´¨é‡
- âœ… **DDDåˆ†å±‚æ¶æ„** - æ¸…æ™°çš„é¢†åŸŸå±‚ã€åº”ç”¨å±‚ã€åŸºç¡€è®¾æ–½å±‚ã€æœåŠ¡å±‚
- âœ… **äº‹ä»¶é©±åŠ¨æ¶æ„** - åŸºäºMediatRçš„äº‹ä»¶é©±åŠ¨è®¾è®¡
- âœ… **ä¸­å¤®åŒ…ç®¡ç†** - Directory.Packages.propsç»Ÿä¸€ç®¡ç†ä¾èµ–
- âœ… **ä¸­æ–‡æ³¨é‡Š** - æ ¸å¿ƒä»£ç å…¨ä¸­æ–‡æ³¨é‡Š
- âœ… **ç‹¬ç«‹æ–‡ä»¶** - æ‰€æœ‰ç±»ã€æšä¸¾ã€äº‹ä»¶ç‹¬ç«‹æ–‡ä»¶å­˜æ”¾
- âœ… **æ¡ä»¶ç¼–è¯‘** - Debugæ¨¡å¼ä¸‹æ§åˆ¶å°åº”ç”¨ï¼ŒReleaseæ¨¡å¼ä¸‹WindowsæœåŠ¡

### è¿ç»´ä¸éƒ¨ç½²
- âœ… **WindowsæœåŠ¡** - ä½œä¸ºWindowsæœåŠ¡è¿è¡Œï¼Œç¨³å®šå¯é 
- âœ… **è‡ªåŠ¨è¿ç§»** - EF Coreè‡ªåŠ¨åº”ç”¨æ•°æ®åº“è¿ç§»
- âœ… **å¥åº·æ£€æŸ¥** - /healthç«¯ç‚¹ç›‘æ§æœåŠ¡çŠ¶æ€
- âœ… **Kestrelä¼˜åŒ–** - è¿æ¥æ•°ã€ç¼“å†²åŒºã€è¶…æ—¶ç­‰é…ç½®ä¼˜åŒ–
- âœ… **æ—¥å¿—æ–‡ä»¶æ¸…ç†** - è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ—¥å¿—æ–‡ä»¶ï¼ˆé»˜è®¤7å¤©ï¼‰
- âœ… **ç‰ˆæœ¬ä¿¡æ¯API** - æŸ¥è¯¢ç³»ç»Ÿç‰ˆæœ¬å’Œæ„å»ºä¿¡æ¯

## é¡¹ç›®å®Œæˆåº¦

### æ ¸å¿ƒåŠŸèƒ½å®Œæˆåº¦ï¼š95%
- âœ… åŒ…è£¹åˆ†æ‹£æ ¸å¿ƒæµç¨‹ - 100%
- âœ… è§„åˆ™å¼•æ“ä¸åŒ¹é… - 100%
- âœ… å¤šåè®®é€šä¿¡æ”¯æŒ - 100%
- âœ… æ•°æ®åº“é™çº§ä¸æ¢å¤ - 100%
- âœ… æ€§èƒ½ç›‘æ§ä¸ä¼˜åŒ– - 95%
- â³ APIå“åº”DTOè§„èŒƒåŒ– - å¾…å®æ–½

### ç”Ÿäº§å°±ç»ªåº¦ï¼š90%
- âœ… å¼¹æ€§ä¸å®¹é”™æœºåˆ¶ - 100%
- âœ… ç›‘æ§ä¸æ—¥å¿—ç³»ç»Ÿ - 95%
- âœ… æ€§èƒ½ä¼˜åŒ– - 95%
- âœ… æµ‹è¯•è¦†ç›– - 85%
- â³ APIæ–‡æ¡£å®Œå–„åº¦ - 85%
- â³ å¥åº·æ£€æŸ¥å¢å¼º - 80%

### æ¨èç”Ÿäº§ç¯å¢ƒé…ç½®
- âœ… MySQL + SQLiteåŒæ•°æ®åº“æ¶æ„
- âœ… SignalRæˆ–TouchSocket TCPé€šä¿¡
- âœ… æ•°æ®åº“ç†”æ–­å™¨ï¼ˆ50%å¤±è´¥ç‡ï¼Œ20åˆ†é’Ÿç†”æ–­ï¼‰
- âœ… è‡ªåŠ¨æ•°æ®æ¸…ç†ï¼ˆ90å¤©ä¿ç•™ï¼Œ30å¤©å½’æ¡£ï¼‰
- âœ… NLogæ—¥å¿—è½®è½¬ï¼ˆ7å¤©ä¿ç•™ï¼‰
- â³ å»ºè®®é…åˆè´Ÿè½½å‡è¡¡ï¼ˆè§„åˆ’ä¸­ï¼‰

### å½“å‰ç‰ˆæœ¬ï¼šv1.11.0
- **ç¨³å®šæ€§**ï¼šç”Ÿäº§çº§ï¼ˆProduction-Readyï¼‰
- **æ€§èƒ½**ï¼š50æ¬¡/ç§’åŒ…è£¹å¤„ç†èƒ½åŠ›
- **å¯é æ€§**ï¼šè‡ªåŠ¨é™çº§æ¢å¤ï¼Œé›¶æ•°æ®ä¸¢å¤±
- **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°åˆ†å±‚æ¶æ„ï¼Œå®Œæ•´ä¸­æ–‡æ³¨é‡Š
- **å¯æ‰©å±•æ€§**ï¼šé€‚é…å™¨æ¨¡å¼ï¼Œçƒ­åˆ‡æ¢æ”¯æŒ

## æ¶æ„è®¾è®¡

é¡¹ç›®é‡‡ç”¨æ¸…æ™°çš„åˆ†å±‚æ¶æ„ï¼ˆClean Architecture / DDDï¼‰ï¼š

```
ZakYip.Sorting.RuleEngine/
â”œâ”€â”€ ZakYip.Sorting.RuleEngine.Domain/          # é¢†åŸŸå±‚
â”‚   â”œâ”€â”€ Entities/                              # å®ä½“
â”‚   â”‚   â”œâ”€â”€ ParcelInfo.cs                      # åŒ…è£¹ä¿¡æ¯å®ä½“
â”‚   â”‚   â”œâ”€â”€ DwsData.cs                         # DWSæ•°æ®å®ä½“
â”‚   â”‚   â”œâ”€â”€ SortingRule.cs                     # åˆ†æ‹£è§„åˆ™å®ä½“
â”‚   â”‚   â””â”€â”€ ThirdPartyResponse.cs              # ç¬¬ä¸‰æ–¹APIå“åº”å®ä½“
â”‚   â””â”€â”€ Interfaces/                            # é¢†åŸŸæ¥å£
â”‚       â”œâ”€â”€ IRuleEngineService.cs              # è§„åˆ™å¼•æ“æœåŠ¡æ¥å£
â”‚       â”œâ”€â”€ IRuleRepository.cs                 # è§„åˆ™ä»“å‚¨æ¥å£
â”‚       â”œâ”€â”€ IThirdPartyApiClient.cs            # ç¬¬ä¸‰æ–¹APIå®¢æˆ·ç«¯æ¥å£
â”‚       â””â”€â”€ ILogRepository.cs                  # æ—¥å¿—ä»“å‚¨æ¥å£
â”‚
â”œâ”€â”€ ZakYip.Sorting.RuleEngine.Application/     # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ Services/                              # åº”ç”¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ ParcelProcessingService.cs         # åŒ…è£¹å¤„ç†æœåŠ¡ï¼ˆé«˜æ€§èƒ½ï¼‰
â”‚   â”‚   â””â”€â”€ RuleEngineService.cs               # è§„åˆ™å¼•æ“æœåŠ¡ï¼ˆå¸¦ç¼“å­˜ï¼‰
â”‚   â”œâ”€â”€ DTOs/                                  # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ ParcelProcessRequest.cs            # åŒ…è£¹å¤„ç†è¯·æ±‚
â”‚   â”‚   â””â”€â”€ ParcelProcessResponse.cs           # åŒ…è£¹å¤„ç†å“åº”
â”‚   â””â”€â”€ Interfaces/                            # åº”ç”¨æ¥å£
â”‚       â””â”€â”€ IParcelProcessingService.cs        # åŒ…è£¹å¤„ç†æœåŠ¡æ¥å£
â”‚
â”œâ”€â”€ ZakYip.Sorting.RuleEngine.Infrastructure/  # åŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ Persistence/                           # æŒä¹…åŒ–å®ç°
â”‚   â”‚   â”œâ”€â”€ LiteDb/                           # LiteDBå®ç°ï¼ˆé…ç½®å­˜å‚¨ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ LiteDbRuleRepository.cs       # è§„åˆ™ä»“å‚¨å®ç°
â”‚   â”‚   â”œâ”€â”€ MySql/                            # MySQLå®ç°ï¼ˆæ—¥å¿—å­˜å‚¨ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ MySqlLogDbContext.cs          # MySQLæ•°æ®åº“ä¸Šä¸‹æ–‡
â”‚   â”‚   â”‚   â””â”€â”€ MySqlLogRepository.cs         # MySQLæ—¥å¿—ä»“å‚¨
â”‚   â”‚   â””â”€â”€ Sqlite/                           # SQLiteå®ç°ï¼ˆé™çº§æ–¹æ¡ˆï¼‰
â”‚   â”‚       â”œâ”€â”€ SqliteLogDbContext.cs         # SQLiteæ•°æ®åº“ä¸Šä¸‹æ–‡
â”‚   â”‚       â””â”€â”€ SqliteLogRepository.cs        # SQLiteæ—¥å¿—ä»“å‚¨
â”‚   â””â”€â”€ ApiClients/                           # APIå®¢æˆ·ç«¯
â”‚       â””â”€â”€ ThirdPartyApiClient.cs            # ç¬¬ä¸‰æ–¹APIå®¢æˆ·ç«¯å®ç°
â”‚
â””â”€â”€ ZakYip.Sorting.RuleEngine.Service/         # æœåŠ¡å±‚ï¼ˆWindows Service + MiniAPIï¼‰
    â”œâ”€â”€ API/                                   # APIæ§åˆ¶å™¨
    â”‚   â”œâ”€â”€ ParcelController.cs               # åŒ…è£¹å¤„ç†API
    â”‚   â””â”€â”€ RuleController.cs                 # è§„åˆ™ç®¡ç†API
    â”œâ”€â”€ Configuration/                         # é…ç½®
    â”‚   â””â”€â”€ AppSettings.cs                    # åº”ç”¨é…ç½®ç±»
    â”œâ”€â”€ appsettings.json                      # é…ç½®æ–‡ä»¶
    â””â”€â”€ Program.cs                            # ä¸»ç¨‹åºå…¥å£
```

## æŠ€æœ¯æ ˆ

- **.NET 8.0** - æœ€æ–°çš„.NETæ¡†æ¶
- **ASP.NET Core Minimal API** - è½»é‡çº§Web API
- **Kestrel** - é«˜æ€§èƒ½WebæœåŠ¡å™¨
- **MediatR** - äº‹ä»¶é©±åŠ¨æ¶æ„å®ç°
- **EFCore.Sharding** - æ—¶é—´ç»´åº¦æ•°æ®åˆ†ç‰‡
- **LiteDB** - åµŒå…¥å¼NoSQLæ•°æ®åº“ï¼ˆé…ç½®å­˜å‚¨ï¼‰
- **Entity Framework Core** - ORMæ¡†æ¶ï¼Œæ”¯æŒè‡ªåŠ¨è¿ç§»
- **MySQL / SQLite** - å…³ç³»å‹æ•°æ®åº“ï¼ˆæ—¥å¿—å­˜å‚¨ï¼‰
- **Polly** - å¼¹æ€§å’Œç¬æ€æ•…éšœå¤„ç†ï¼ˆé‡è¯•ã€ç†”æ–­å™¨ï¼‰
- **IMemoryCache** - æ»‘åŠ¨è¿‡æœŸå†…å­˜ç¼“å­˜
- **System.Threading.Channels** - FIFOé˜Ÿåˆ—å®ç°
- **TouchSocket** - é«˜æ€§èƒ½TCPé€šä¿¡åº“
- **SignalR** - å®æ—¶åŒå‘é€šä¿¡
- **NLog** - é«˜æ€§èƒ½æ—¥å¿—æ¡†æ¶
- **Newtonsoft.Json** - JSONåºåˆ—åŒ–åº“
- **Swagger/OpenAPI** - APIæ–‡æ¡£
- **Object Pool** - å¯¹è±¡æ± ä¼˜åŒ–æ€§èƒ½
- **xUnit / Moq** - å•å…ƒæµ‹è¯•æ¡†æ¶
- **BenchmarkDotNet** - æ€§èƒ½åŸºå‡†æµ‹è¯•æ¡†æ¶
- **Windows Services** - WindowsæœåŠ¡æ‰˜ç®¡

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- .NET 8.0 SDK
- Visual Studio 2022 æˆ– Visual Studio Code
- ï¼ˆå¯é€‰ï¼‰MySQLæœåŠ¡å™¨

### æ„å»ºé¡¹ç›®

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/Hisoka6602/ZakYip.Sorting.RuleEngine.Core.git
cd ZakYip.Sorting.RuleEngine

# è¿˜åŸä¾èµ–å¹¶æ„å»º
dotnet restore
dotnet build
```

### é…ç½®

ç¼–è¾‘ `ZakYip.Sorting.RuleEngine.Service/appsettings.json` é…ç½®æ–‡ä»¶ï¼š

```json
{
  "AppSettings": {
    "LiteDb": {
      "ConnectionString": "Filename=./data/config.db;Connection=shared"
    },
    "MySql": {
      "ConnectionString": "Server=localhost;Database=sorting_logs;User=root;Password=your_password;",
      "Enabled": true
    },
    "Sqlite": {
      "ConnectionString": "Data Source=./data/logs.db"
    },
    "ThirdPartyApi": {
      "BaseUrl": "https://api.example.com",
      "TimeoutSeconds": 30,
      "ApiKey": ""
    },
    "MiniApi": {
      "Urls": [ "http://localhost:5000" ],
      "EnableSwagger": true
    }
  }
}
```

### è¿è¡ŒæœåŠ¡

#### å¼€å‘æ¨¡å¼

```bash
cd ZakYip.Sorting.RuleEngine.Service
dotnet run
```

è®¿é—® Swagger UI: http://localhost:5000/swagger

#### ä½œä¸ºWindowsæœåŠ¡å®‰è£…

```powershell
# å‘å¸ƒåº”ç”¨
dotnet publish -c Release -o ./publish

# åˆ›å»ºWindowsæœåŠ¡
sc create "ZakYipSortingEngine" binPath="C:\path\to\publish\ZakYip.Sorting.RuleEngine.Service.exe"

# å¯åŠ¨æœåŠ¡
sc start "ZakYipSortingEngine"
```

## é€šä¿¡æ–¹å¼

### SignalR Hubï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

ç³»ç»Ÿæä¾›SignalR Hubç”¨äºå®æ—¶åŒå‘é€šä¿¡ï¼Œè¿™æ˜¯**ç”Ÿäº§ç¯å¢ƒæ¨èçš„é€šä¿¡æ–¹å¼**ã€‚

#### 1. åˆ†æ‹£æœºHubï¼ˆSortingHubï¼‰

è¿æ¥åœ°å€ï¼š`/hubs/sorting`

**æ–¹æ³•ï¼šåˆ›å»ºåŒ…è£¹å¤„ç†ç©ºé—´**
```javascript
// å®¢æˆ·ç«¯è°ƒç”¨
const result = await connection.invoke("CreateParcel", "PKG20241024001", "CART001", "1234567890123");
// è¿”å›: { success: true, parcelId: "PKG20241024001", message: "åŒ…è£¹å¤„ç†ç©ºé—´å·²åˆ›å»ºï¼Œç­‰å¾…DWSæ•°æ®" }
```

**æ¥æ”¶æ ¼å£å·ç»“æœ**
```javascript
// å®¢æˆ·ç«¯ç›‘å¬
connection.on("ReceiveChuteNumber", (parcelId, chuteNumber, cartNumber, cartCount) => {
    console.log(`åŒ…è£¹ ${parcelId} åˆ†é…åˆ°æ ¼å£ ${chuteNumber}`);
});
```

#### 2. DWS Hubï¼ˆDwsHubï¼‰

è¿æ¥åœ°å€ï¼š`/hubs/dws`

**æ–¹æ³•ï¼šæ¥æ”¶DWSæ•°æ®**
```javascript
// å®¢æˆ·ç«¯è°ƒç”¨
const result = await connection.invoke("ReceiveDwsData", 
    "PKG20241024001", 
    "1234567890123", 
    1500,  // weight
    300,   // length
    200,   // width
    150,   // height
    9000   // volume
);
// è¿”å›: { success: true, parcelId: "PKG20241024001", message: "DWSæ•°æ®å·²æ¥æ”¶ï¼Œå¼€å§‹å¤„ç†" }
```

#### 3. SignalRè¿æ¥ç¤ºä¾‹ï¼ˆC#ï¼‰

```csharp
using Microsoft.AspNetCore.SignalR.Client;

// åˆ†æ‹£æœºè¿æ¥
var sortingConnection = new HubConnectionBuilder()
    .WithUrl("http://localhost:5000/hubs/sorting")
    .WithAutomaticReconnect()
    .Build();

// ç›‘å¬æ ¼å£å·
sortingConnection.On<string, string, string, int>("ReceiveChuteNumber", 
    (parcelId, chuteNumber, cartNumber, cartCount) =>
{
    Console.WriteLine($"åŒ…è£¹ {parcelId} åˆ†é…åˆ°æ ¼å£ {chuteNumber}");
});

await sortingConnection.StartAsync();

// åˆ›å»ºåŒ…è£¹
var result = await sortingConnection.InvokeAsync<object>(
    "CreateParcel", "PKG001", "CART001", "123456");

// DWSè¿æ¥
var dwsConnection = new HubConnectionBuilder()
    .WithUrl("http://localhost:5000/hubs/dws")
    .WithAutomaticReconnect()
    .Build();

await dwsConnection.StartAsync();

// å‘é€DWSæ•°æ®
var dwsResult = await dwsConnection.InvokeAsync<object>(
    "ReceiveDwsData", "PKG001", "123456", 1500, 300, 200, 150, 9000);
```

#### 4. TouchSocket TCPé€šä¿¡ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èï¼‰

ç³»ç»Ÿä½¿ç”¨TouchSocketåº“å®ç°é«˜æ€§èƒ½TCPé€šä¿¡ï¼Œæ”¯æŒè¿æ¥æ± å’Œè‡ªåŠ¨é‡è¿ã€‚

**DWS TCPé€‚é…å™¨é…ç½®**ï¼š
- é»˜è®¤æœ€å¤§è¿æ¥æ•°ï¼š1000
- å¯é…ç½®æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼š8192å­—èŠ‚
- å¯é…ç½®å‘é€ç¼“å†²åŒºå¤§å°ï¼š8192å­—èŠ‚
- æ”¯æŒè¿æ¥æ± ç®¡ç†

**åˆ†æ‹£æœºTCPé€‚é…å™¨é…ç½®**ï¼š
- è‡ªåŠ¨é‡è¿é—´éš”ï¼š5000æ¯«ç§’
- å¯é…ç½®ç¼“å†²åŒºå¤§å°ï¼š8192å­—èŠ‚
- æ”¯æŒè‡ªåŠ¨æ–­çº¿é‡è¿

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```csharp
// DWSé€‚é…å™¨
var dwsAdapter = new TouchSocketDwsAdapter(
    host: "192.168.1.100",
    port: 8001,
    logger: logger,
    communicationLogRepository: commLogRepo,
    maxConnections: 1000,        // å¯é€‰ï¼Œé»˜è®¤1000
    receiveBufferSize: 8192,     // å¯é€‰ï¼Œé»˜è®¤8192
    sendBufferSize: 8192         // å¯é€‰ï¼Œé»˜è®¤8192
);

// åˆ†æ‹£æœºé€‚é…å™¨
var sorterAdapter = new TouchSocketSorterAdapter(
    host: "192.168.1.200",
    port: 9000,
    logger: logger,
    communicationLogRepository: commLogRepo,
    reconnectIntervalMs: 5000,   // å¯é€‰ï¼Œé»˜è®¤5000
    receiveBufferSize: 8192,     // å¯é€‰ï¼Œé»˜è®¤8192
    sendBufferSize: 8192         // å¯é€‰ï¼Œé»˜è®¤8192
);
```

### HTTP APIï¼ˆä»…ç”¨äºæµ‹è¯•ï¼‰

**æ³¨æ„**ï¼šHTTP APIä»…ç”¨äºæµ‹è¯•å’Œè°ƒè¯•ï¼Œç”Ÿäº§ç¯å¢ƒä¸­åˆ†æ‹£ç¨‹åºå’ŒDWSåº”ä½¿ç”¨TCPæˆ–SignalRé€šä¿¡ã€‚

#### åˆ†æ‹£æœºä¿¡å·API

#### 1. åˆ›å»ºåŒ…è£¹å¤„ç†ç©ºé—´

åˆ†æ‹£ç¨‹åºæ¨é€åŒ…è£¹IDå’Œå°è½¦å·ï¼Œç³»ç»Ÿåˆ›å»ºå¤„ç†ç©ºé—´ç­‰å¾…DWSæ•°æ®ã€‚

```http
POST /api/sortingmachine/create-parcel
Content-Type: application/json

{
  "parcelId": "PKG20241024001",
  "cartNumber": "CART001",
  "barcode": "1234567890123"
}
```

å“åº”ï¼š

```json
{
  "success": true,
  "parcelId": "PKG20241024001",
  "message": "åŒ…è£¹å¤„ç†ç©ºé—´å·²åˆ›å»ºï¼Œç­‰å¾…DWSæ•°æ®"
}
```

#### 2. æ¥æ”¶DWSæ•°æ®

ä¸Šä¼ DWSå†…å®¹ï¼Œè§¦å‘ç¬¬ä¸‰æ–¹APIè°ƒç”¨å’Œè§„åˆ™åŒ¹é…ã€‚

```http
POST /api/sortingmachine/receive-dws
Content-Type: application/json

{
  "parcelId": "PKG20241024001",
  "barcode": "1234567890123",
  "weight": 1500,
  "length": 300,
  "width": 200,
  "height": 150,
  "volume": 9000
}
```

å“åº”ï¼š

```json
{
  "success": true,
  "parcelId": "PKG20241024001",
  "message": "DWSæ•°æ®å·²æ¥æ”¶ï¼Œå¼€å§‹å¤„ç†"
}
```

**å®Œæ•´æµç¨‹è¯´æ˜**ï¼š
1. åˆ†æ‹£ç¨‹åºè°ƒç”¨ `create-parcel` åˆ›å»ºåŒ…è£¹å¤„ç†ç©ºé—´
2. åŒ…è£¹è¿›å…¥FIFOé˜Ÿåˆ—ï¼Œä¿è¯å…ˆè¿›å…ˆå‡ºå¤„ç†
3. åˆ†æ‹£ç¨‹åºè°ƒç”¨ `receive-dws` ä¸Šä¼ DWSæ•°æ®
4. ç³»ç»Ÿè‡ªåŠ¨ä¸Šä¼ æ•°æ®åˆ°ç¬¬ä¸‰æ–¹API
5. æ‰§è¡Œè§„åˆ™åŒ¹é…ï¼Œç¡®å®šæ ¼å£å·
6. å°†ç»“æœï¼ˆæ ¼å£å·ã€åŒ…è£¹IDã€å°è½¦å·ã€å ç”¨å°è½¦æ•°ï¼‰å‘é€ç»™åˆ†æ‹£ç¨‹åº
7. å…³é—­å¤„ç†ç©ºé—´ï¼Œä»ç¼“å­˜åˆ é™¤

### åŒ…è£¹å¤„ç†APIï¼ˆå…¼å®¹æ—§ç‰ˆï¼‰

#### 1. å¤„ç†å•ä¸ªåŒ…è£¹

```http
POST /api/parcel/process
Content-Type: application/json

{
  "parcelId": "PKG001",
  "cartNumber": "CART001",
  "barcode": "1234567890",
  "weight": 1500,
  "length": 300,
  "width": 200,
  "height": 150,
  "volume": 9000
}
```

å“åº”ï¼š

```json
{
  "success": true,
  "parcelId": "PKG001",
  "chuteNumber": "CHUTE-A01",
  "errorMessage": null,
  "processingTimeMs": 45
}
```

#### 2. æ‰¹é‡å¤„ç†åŒ…è£¹

```http
POST /api/parcel/process/batch
Content-Type: application/json

[
  { "parcelId": "PKG001", "cartNumber": "CART001", ... },
  { "parcelId": "PKG002", "cartNumber": "CART002", ... }
]
```

### è§„åˆ™ç®¡ç†API

#### 1. è·å–æ‰€æœ‰è§„åˆ™

```http
GET /api/rule
```

#### 2. æ·»åŠ è§„åˆ™

```http
POST /api/rule
Content-Type: application/json

{
  "ruleId": "RULE001",
  "ruleName": "é‡é‡è§„åˆ™",
  "description": "é‡é‡å¤§äº1000å…‹åˆ†é…åˆ°AåŒº",
  "priority": 1,
  "conditionExpression": "Weight > 1000",
  "targetChute": "CHUTE-A01",
  "isEnabled": true
}
```

#### 3. æ›´æ–°è§„åˆ™

```http
PUT /api/rule/RULE001
Content-Type: application/json

{
  "ruleId": "RULE001",
  "ruleName": "é‡é‡è§„åˆ™ï¼ˆå·²æ›´æ–°ï¼‰",
  ...
}
```

#### 4. åˆ é™¤è§„åˆ™

```http
DELETE /api/rule/RULE001
```

## è§„åˆ™è¡¨è¾¾å¼è¯­æ³•

è§„åˆ™å¼•æ“æ”¯æŒå¤šç§åŒ¹é…æ–¹æ³•ï¼Œæ¯ç§æ–¹æ³•é’ˆå¯¹ä¸åŒçš„ä½¿ç”¨åœºæ™¯è¿›è¡Œäº†ä¼˜åŒ–ã€‚

### åŒ¹é…æ–¹æ³•ç±»å‹

#### 1. æ¡ç æ­£åˆ™åŒ¹é… (BarcodeRegex)

æ”¯æŒé¢„è®¾é€‰é¡¹å’Œè‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼š

```
STARTSWITH:SF          # æ¡ç ä»¥SFå¼€å¤´
CONTAINS:ABC           # æ¡ç åŒ…å«ABC
NOTCONTAINS:XYZ        # æ¡ç ä¸åŒ…å«XYZ
ALLDIGITS              # æ¡ç å…¨ä¸ºæ•°å­—
ALPHANUMERIC           # æ¡ç ä¸ºå­—æ¯+æ•°å­—
LENGTH:5-10            # æ¡ç é•¿åº¦åœ¨5-10ä¹‹é—´
REGEX:^SF\d{6}$        # è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼
```

#### 2. é‡é‡åŒ¹é… (WeightMatch)

æ”¯æŒå¤æ‚çš„é€»è¾‘è¡¨è¾¾å¼ï¼š

```
Weight > 50                           # é‡é‡å¤§äº50å…‹
Weight < 100 and Weight > 10          # é‡é‡åœ¨10-100å…‹ä¹‹é—´
Weight > 1000 or Weight < 50          # é‡é‡å¤§äº1000å…‹æˆ–å°äº50å…‹
```

#### 3. ä½“ç§¯åŒ¹é… (VolumeMatch)

æ”¯æŒé•¿å®½é«˜å’Œä½“ç§¯çš„å¤æ‚è¡¨è¾¾å¼ï¼š

```
Length > 20 and Width > 10            # é•¿åº¦å¤§äº20ä¸”å®½åº¦å¤§äº10
Height = 20.5 or Volume > 200         # é«˜åº¦ç­‰äº20.5æˆ–ä½“ç§¯å¤§äº200
Length > 500 or Width > 400           # è¶…å¤§ä»¶åˆ¤æ–­
```

#### 4. OCRåŒ¹é… (OcrMatch)

æ”¯æŒåœ°å€æ®µç å’Œç”µè¯åç¼€åŒ¹é…ï¼š

```
firstSegmentCode=^64\d*$              # ç¬¬ä¸€æ®µç ä»¥64å¼€å¤´ï¼ˆä½¿ç”¨æ­£åˆ™ï¼‰
recipientPhoneSuffix=1234             # æ”¶ä»¶äººç”µè¯åç¼€ä¸º1234
firstSegmentCode=^64\d*$ and recipientPhoneSuffix=1234  # ç»„åˆæ¡ä»¶
```

#### 5. APIå“åº”å†…å®¹åŒ¹é… (ApiResponseMatch)

æ”¯æŒå­—ç¬¦ä¸²æŸ¥æ‰¾ã€æ­£åˆ™æŸ¥æ‰¾å’ŒJSONåŒ¹é…ï¼š

```
STRING:keyword                        # åœ¨å“åº”ä¸­æŸ¥æ‰¾å…³é”®å­—
REGEX:\d{3}                          # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
JSON:status=success                   # åŒ¹é…JSONå­—æ®µ
JSON:data.user.name=John              # åŒ¹é…åµŒå¥—JSONå­—æ®µ
```

#### 6. ä½ä»£ç è¡¨è¾¾å¼åŒ¹é… (LowCodeExpression)

æ”¯æŒæ··åˆä½¿ç”¨å¤šç§æ¡ä»¶ï¼š

```
if(Weight>10) and firstSegmentCode=^64\d*$
Weight > 50 and Length > 300
Barcode=STARTSWITH:SF and Volume > 1000
```

#### 7. ä¼ ç»Ÿè¡¨è¾¾å¼ (LegacyExpression - é»˜è®¤)

å…¼å®¹æ—§ç‰ˆæœ¬çš„è¡¨è¾¾å¼è¯­æ³•ï¼š

```
Weight > 1000          # é‡é‡å¤§äº1000å…‹
Barcode CONTAINS 'SF'  # æ¡ç åŒ…å«SF
Volume < 50000         # ä½“ç§¯å°äº50000ç«‹æ–¹å˜ç±³
DEFAULT                # é»˜è®¤è§„åˆ™ï¼ˆåŒ¹é…æ‰€æœ‰ï¼‰
```

### ç¤ºä¾‹è§„åˆ™é…ç½®

```json
{
  "ruleId": "R001",
  "ruleName": "é¡ºä¸°å¿«é€’",
  "matchingMethod": "BarcodeRegex",
  "conditionExpression": "STARTSWITH:SF",
  "targetChute": "CHUTE-SF-01",
  "priority": 1,
  "isEnabled": true
}
```

è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹ [MATCHING_METHODS.md](./MATCHING_METHODS.md)

## æ€§èƒ½ä¼˜åŒ–

ç³»ç»Ÿé‡‡ç”¨å¤šç§æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼š

1. **å¯¹è±¡æ± ** - ä½¿ç”¨`ObjectPool`é¿å…é¢‘ç¹å¯¹è±¡åˆ›å»º
2. **æ»‘åŠ¨è¿‡æœŸç¼“å­˜** - ä½¿ç”¨`IMemoryCache`ï¼Œæ»‘åŠ¨è¿‡æœŸ5åˆ†é’Ÿï¼Œç»å¯¹è¿‡æœŸ30åˆ†é’Ÿ
3. **å¼‚æ­¥å¤„ç†** - å…¨é¢ä½¿ç”¨async/awaitæ¨¡å¼
4. **æ‰¹é‡å¤„ç†** - æ”¯æŒå¹¶è¡Œæ‰¹é‡å¤„ç†åŒ…è£¹
5. **è¿æ¥å¤ç”¨** - HttpClientå¤ç”¨ï¼Œå‡å°‘è¿æ¥å¼€é”€
6. **TouchSocketä¼˜åŒ–** - TCPè¿æ¥æ± ï¼ˆé»˜è®¤1000è¿æ¥ï¼‰ï¼Œè‡ªåŠ¨é‡è¿ï¼ˆ5ç§’é—´éš”ï¼‰ï¼Œç¼“å†²åŒºä¼˜åŒ–ï¼ˆ8KBï¼‰
7. **ç´¢å¼•ä¼˜åŒ–** - æ•°æ®åº“è¡¨å»ºç«‹é€‚å½“ç´¢å¼•
8. **è‡ªåŠ¨è¿ç§»** - EF Coreè‡ªåŠ¨åº”ç”¨æ•°æ®åº“è¿ç§»ï¼Œç®€åŒ–éƒ¨ç½²
9. **æ€§èƒ½ç›‘æ§** - å…¨é¢çš„æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œç›‘æ§ï¼ˆv1.5.0æ–°å¢ï¼‰

### æ€§èƒ½æŒ‡æ ‡ç›‘æ§

ç³»ç»Ÿè‡ªåŠ¨æ”¶é›†ä»¥ä¸‹æ€§èƒ½æŒ‡æ ‡ï¼š

- **è§„åˆ™è¯„ä¼°æ—¶é•¿** - è·Ÿè¸ªæ¯æ¬¡è§„åˆ™è¯„ä¼°çš„æ‰§è¡Œæ—¶é—´
- **APIè°ƒç”¨æ—¶é•¿** - ç›‘æ§ç¬¬ä¸‰æ–¹APIè°ƒç”¨æ€§èƒ½
- **æ•°æ®åº“æ“ä½œæ—¶é•¿** - è·Ÿè¸ªæ•°æ®åº“æ“ä½œæ€§èƒ½
- **æˆåŠŸç‡ç»Ÿè®¡** - ç»Ÿè®¡æ“ä½œæˆåŠŸç‡
- **P50/P95/P99å»¶è¿Ÿ** - æä¾›è¯¦ç»†çš„å»¶è¿Ÿåˆ†å¸ƒç»Ÿè®¡

æ€§èƒ½æŒ‡æ ‡è‡ªåŠ¨è®°å½•åˆ°æ—¥å¿—ç³»ç»Ÿï¼Œæ”¯æŒæŸ¥è¯¢å’Œåˆ†æã€‚è¯¦ç»†æ–‡æ¡£è¯·æŸ¥çœ‹ [PERFORMANCE_METRICS.md](./PERFORMANCE_METRICS.md)

## å¼¹æ€§å’Œé™çº§ç­–ç•¥

ç³»ç»Ÿå…·å¤‡å®Œå–„çš„å¼¹æ€§å’Œé™çº§æœºåˆ¶ï¼š

1. **æ•°æ®åº“ç†”æ–­å™¨** - ä¸ºMySQLæ•°æ®åº“é…ç½®ç†”æ–­å™¨ï¼Œé˜²æ­¢çº§è”æ•…éšœ
   - å¯é…ç½®çš„å¤±è´¥ç‡é˜ˆå€¼ï¼ˆé»˜è®¤50%ï¼‰
   - å¯é…ç½®çš„ç†”æ–­æŒç»­æ—¶é—´ï¼ˆé»˜è®¤20åˆ†é’Ÿï¼‰
   - å¯é…ç½®çš„é‡‡æ ·å‘¨æœŸå’Œæœ€å°ååé‡
   - MySQLå¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ°SQLiteå­˜å‚¨æ‰€æœ‰æ—¥å¿—
   - MySQLæ¢å¤åè‡ªåŠ¨æ‰§è¡Œå®Œæ•´æ•°æ®åŒæ­¥ï¼š
     - åŒæ­¥æ‰€æœ‰7ç§æ—¥å¿—è¡¨æ•°æ®ï¼ˆLogEntryã€CommunicationLogã€SorterCommunicationLogã€DwsCommunicationLogã€ApiCommunicationLogã€MatchingLogã€ApiRequestLogï¼‰
     - æŒ‰æ—¶é—´é¡ºåºæ‰¹é‡æ’å…¥åˆ°MySQL
     - åŒæ­¥æˆåŠŸåæ¸…ç©ºSQLiteæ‰€æœ‰è¡¨
     - æ‰§è¡ŒVACUUMå‘½ä»¤å‹ç¼©SQLiteæ•°æ®åº“æ–‡ä»¶
     - è‡ªåŠ¨è®°å½•åŒæ­¥è¿›åº¦å’Œç»“æœ
2. **HTTPå®¢æˆ·ç«¯æ± åŒ–** - ä½¿ç”¨HttpClientFactoryæ± åŒ–ç®¡ç†HTTPè¿æ¥
   - é¿å…ç«¯å£è€—å°½é—®é¢˜
   - **æ³¨æ„ï¼šHTTPè¯·æ±‚ä¸ä½¿ç”¨ç†”æ–­å™¨**
3. **APIå®¹é”™** - ç¬¬ä¸‰æ–¹APIå¤±è´¥æ—¶ä»å¯ä½¿ç”¨è§„åˆ™å¼•æ“
4. **è§„åˆ™ç¼“å­˜** - æ•°æ®åº“ä¸å¯ç”¨æ—¶ä½¿ç”¨ç¼“å­˜è§„åˆ™
5. **å¯é…ç½®ç¼“å­˜** - æ”¯æŒé…ç½®ç»å¯¹è¿‡æœŸå’Œæ»‘åŠ¨è¿‡æœŸæ—¶é—´

## äº‹ä»¶é©±åŠ¨æ¶æ„

ç³»ç»Ÿé‡‡ç”¨MediatRå®ç°å®Œæ•´çš„äº‹ä»¶é©±åŠ¨æ¶æ„ï¼š

### å·¥ä½œæµç¨‹

```
1. åˆ†æ‹£ç¨‹åºå‘é€ä¿¡å· â†’ åˆ›å»ºåŒ…è£¹å¤„ç†ç©ºé—´ï¼ˆå¼€è¾Ÿç¼“å­˜ï¼‰
2. åŒ…è£¹è¿›å…¥FIFOé˜Ÿåˆ— â†’ ä¿è¯å…ˆè¿›å…ˆå‡ºå¤„ç†
3. æ¥æ”¶DWSæ•°æ® â†’ è§¦å‘æ•°æ®å¤„ç†äº‹ä»¶
4. ä¸Šä¼ ç¬¬ä¸‰æ–¹API â†’ è·å–é¢å¤–ä¿¡æ¯
5. æ‰§è¡Œè§„åˆ™åŒ¹é… â†’ ç¡®å®šæ ¼å£å·
6. å‘é€ç»“æœç»™åˆ†æ‹£ç¨‹åº â†’ å®Œæˆåˆ†æ‹£
7. æ¸…ç†ç¼“å­˜ç©ºé—´ â†’ é‡Šæ”¾èµ„æº
```

### é¢†åŸŸäº‹ä»¶

- **ParcelCreatedEvent** - åŒ…è£¹åˆ›å»ºäº‹ä»¶
- **DwsDataReceivedEvent** - DWSæ•°æ®æ¥æ”¶äº‹ä»¶
- **ThirdPartyResponseReceivedEvent** - ç¬¬ä¸‰æ–¹APIå“åº”äº‹ä»¶
- **RuleMatchCompletedEvent** - è§„åˆ™åŒ¹é…å®Œæˆäº‹ä»¶

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [EVENT_DRIVEN_AND_SHARDING.md](./EVENT_DRIVEN_AND_SHARDING.md)

## æ•°æ®åˆ†ç‰‡å’Œè‡ªåŠ¨ç®¡ç†

### æ—¶é—´ç»´åº¦åˆ†è¡¨

ä½¿ç”¨EFCore.Shardingå®ç°æŒ‰æ—¶é—´ç»´åº¦çš„è¡¨åˆ†åŒºï¼š

- **æœˆåº¦åˆ†ç‰‡** - é»˜è®¤ç­–ç•¥ï¼Œé€‚åˆä¸­ç­‰æ•°æ®é‡
- **æ—¥åº¦åˆ†ç‰‡** - é€‚åˆé«˜é¢‘æ•°æ®åœºæ™¯
- **å‘¨åº¦åˆ†ç‰‡** - é€‚åˆä½é¢‘æ•°æ®åœºæ™¯

### çƒ­å†·æ•°æ®åˆ†ç¦»

- **çƒ­æ•°æ®**: æœ€è¿‘30å¤©ï¼Œå­˜å‚¨åœ¨ä¸»è¡¨ï¼Œé¢‘ç¹è®¿é—®
- **å†·æ•°æ®**: 30å¤©ä»¥å‰ï¼Œå¯å½’æ¡£åˆ°å†å²è¡¨ï¼ŒæŸ¥è¯¢è¾ƒå°‘

### è‡ªåŠ¨æ•°æ®æ¸…ç†

- é»˜è®¤ä¿ç•™90å¤©æ•°æ®
- **åŸºäºç©ºé—²ç­–ç•¥æ¸…ç†**ï¼ˆé»˜è®¤30åˆ†é’Ÿæ— åŒ…è£¹åˆ›å»ºåè§¦å‘ï¼‰
- æ¸…ç†å¯è¢«æ–°åŒ…è£¹åˆ›å»ºæ‰“æ–­
- å¯é…ç½®æ¸…ç†ç­–ç•¥å’Œä¿ç•™æœŸ

### åˆ†ç‰‡è¡¨è‡ªåŠ¨ç®¡ç†

- **è‡ªåŠ¨åˆ›å»ºåˆ†ç‰‡è¡¨**ï¼ˆæ ¹æ®ç­–ç•¥æå‰åˆ›å»ºï¼‰
- æ”¯æŒæ—¥åº¦ã€å‘¨åº¦ã€æœˆåº¦åˆ†ç‰‡
- è‡ªåŠ¨åˆ›å»ºç´¢å¼•ä¼˜åŒ–æ€§èƒ½
- æ¯å°æ—¶æ£€æŸ¥ç¡®ä¿è¡¨å­˜åœ¨

### MySQLè‡ªåŠ¨è°ƒè°

åå°æœåŠ¡è‡ªåŠ¨ç›‘æ§å’Œä¼˜åŒ–MySQLæ€§èƒ½ï¼š

- **è¡¨ç»Ÿè®¡åˆ†æ** - ç›‘æ§è¡¨å¤§å°å’Œè¡Œæ•°
- **ç´¢å¼•ä½¿ç”¨åˆ†æ** - è¯†åˆ«æœªä½¿ç”¨çš„ç´¢å¼•
- **è¿æ¥æ± ç›‘æ§** - ä¼˜åŒ–è¿æ¥æ± é…ç½®
- **æ…¢æŸ¥è¯¢è¯†åˆ«** - å‘ç°å¹¶ä¼˜åŒ–æ…¢æŸ¥è¯¢

## ç›‘æ§å’Œæ—¥å¿—

- **ç»“æ„åŒ–æ—¥å¿—** - ä½¿ç”¨Microsoft.Extensions.Logging
- **æ•°æ®åº“æ—¥å¿—** - æŒä¹…åŒ–åˆ°MySQLæˆ–SQLite
- **é€šä¿¡æ—¥å¿—** - å…¨é‡è®°å½•TCP/SignalR/HTTPé€šä¿¡ï¼Œå­˜å‚¨åˆ°communication_logsè¡¨
- **å¥åº·æ£€æŸ¥** - `/health` ç«¯ç‚¹ç›‘æ§æœåŠ¡çŠ¶æ€
- **ç†”æ–­å™¨ç›‘æ§** - è®°å½•ç†”æ–­å™¨çŠ¶æ€å˜åŒ–å’Œå¼‚å¸¸

## å¤šåè®®æ”¯æŒå’Œçƒ­åˆ‡æ¢

ç³»ç»Ÿé€šè¿‡é€‚é…å™¨æ¨¡å¼æ”¯æŒå¤šç§é€šä¿¡åè®®ï¼ˆTCP/SignalRï¼‰ï¼Œå¹¶æ”¯æŒè¿è¡Œæ—¶çƒ­åˆ‡æ¢ã€‚

**é‡è¦è¯´æ˜**ï¼šç”Ÿäº§ç¯å¢ƒä¸­ï¼Œåˆ†æ‹£ç¨‹åºå’ŒDWSè®¾å¤‡åº”ä½¿ç”¨TCPæˆ–SignalRé€šä¿¡ï¼Œä¸åº”ä½¿ç”¨HTTP APIã€‚HTTP APIä»…ç”¨äºæµ‹è¯•å’Œè°ƒè¯•ã€‚

### SignalR Hubï¼ˆæ¨èï¼‰
- **SortingHub** - `/hubs/sorting` åˆ†æ‹£æœºå®æ—¶é€šä¿¡
- **DwsHub** - `/hubs/dws` DWSå®æ—¶é€šä¿¡
- **è‡ªåŠ¨é‡è¿** - æ”¯æŒè‡ªåŠ¨é‡è¿æœºåˆ¶
- **åŒå‘é€šä¿¡** - æ”¯æŒæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ¶ˆæ¯
- **å®Œæ•´æ—¥å¿—** - è®°å½•æ‰€æœ‰SignalRé€šä¿¡åˆ°æ•°æ®åº“

### DWSé€‚é…å™¨ï¼ˆIDwsAdapterï¼‰
- **TouchSocket TCP** - `TouchSocketDwsAdapter` é«˜æ€§èƒ½TCPé€šä¿¡
  - è¿æ¥æ± å¤§å°ï¼šé»˜è®¤1000ï¼Œå¯é…ç½®
  - ç¼“å†²åŒºå¤§å°ï¼šé»˜è®¤8192å­—èŠ‚ï¼Œå¯é…ç½®
  - æ”¯æŒå¹¶å‘è¿æ¥ç®¡ç†
- **æ”¯æŒçƒ­åˆ‡æ¢** - å¯åœ¨è¿è¡Œæ—¶åˆ‡æ¢ä¸åŒå‚å•†çš„DWSè®¾å¤‡
- **å®Œæ•´æ—¥å¿—** - è®°å½•æ‰€æœ‰æ¥æ”¶çš„DWSæ•°æ®åˆ°æ•°æ®åº“

ä½¿ç”¨ç¤ºä¾‹ï¼š
```csharp
// æ³¨å†ŒDWSé€‚é…å™¨ï¼ˆå¸¦ä¼˜åŒ–é…ç½®ï¼‰
services.AddSingleton<IDwsAdapter>(sp => 
    new TouchSocketDwsAdapter(
        host: "192.168.1.100", 
        port: 8001, 
        logger: logger, 
        commLogRepo: commLogRepo,
        maxConnections: 1000,      // å¯é€‰
        receiveBufferSize: 8192,   // å¯é€‰
        sendBufferSize: 8192       // å¯é€‰
    ));

// ä½¿ç”¨é€‚é…å™¨ç®¡ç†å™¨æ”¯æŒçƒ­åˆ‡æ¢
services.AddSingleton<IAdapterManager<IDwsAdapter>>(sp => 
    new AdapterManager<IDwsAdapter>(
        sp.GetServices<IDwsAdapter>(), 
        "TouchSocket-DWS", 
        logger));
```

### åˆ†æ‹£æœºé€‚é…å™¨ï¼ˆISorterAdapterï¼‰
- **TouchSocket TCP** - `TouchSocketSorterAdapter` é«˜æ€§èƒ½TCPé€šä¿¡
  - è‡ªåŠ¨é‡è¿ï¼šé»˜è®¤5ç§’é—´éš”ï¼Œå¯é…ç½®
  - ç¼“å†²åŒºå¤§å°ï¼šé»˜è®¤8192å­—èŠ‚ï¼Œå¯é…ç½®
  - æ–­çº¿è‡ªåŠ¨æ¢å¤
- **æ ‡å‡†TCP** - `TcpSorterAdapter` æ”¯æŒæ ‡å‡†TCPé€šä¿¡
- **æ”¯æŒçƒ­åˆ‡æ¢** - å¯åœ¨è¿è¡Œæ—¶åˆ‡æ¢ä¸åŒå‚å•†çš„åˆ†æ‹£æœº
- **å®Œæ•´æ—¥å¿—** - è®°å½•æ‰€æœ‰å‘é€çš„åˆ†æ‹£æŒ‡ä»¤åˆ°æ•°æ®åº“

ä½¿ç”¨ç¤ºä¾‹ï¼š
```csharp
// æ³¨å†Œåˆ†æ‹£æœºé€‚é…å™¨ï¼ˆå¸¦ä¼˜åŒ–é…ç½®ï¼‰
services.AddSingleton<ISorterAdapter>(sp => 
    new TouchSocketSorterAdapter(
        host: "192.168.1.200", 
        port: 9000, 
        logger: logger, 
        commLogRepo: commLogRepo,
        reconnectIntervalMs: 5000,  // å¯é€‰
        receiveBufferSize: 8192,    // å¯é€‰
        sendBufferSize: 8192        // å¯é€‰
    ));

// ä½¿ç”¨é€‚é…å™¨ç®¡ç†å™¨æ”¯æŒçƒ­åˆ‡æ¢
services.AddSingleton<IAdapterManager<ISorterAdapter>>(sp => 
    new AdapterManager<ISorterAdapter>(
        sp.GetServices<ISorterAdapter>(), 
        "TouchSocket-Sorter", 
        logger));
```

### ç¬¬ä¸‰æ–¹APIé€‚é…å™¨ï¼ˆIThirdPartyAdapterï¼‰
- **HTTPåè®®** - `HttpThirdPartyAdapter` å¸¦ç†”æ–­å™¨çš„HTTPé€šä¿¡
- **æ”¯æŒçƒ­åˆ‡æ¢** - å¯åœ¨è¿è¡Œæ—¶åˆ‡æ¢ä¸åŒçš„APIæä¾›å•†
- **å¯æ‰©å±•** - é€šè¿‡å®ç°`IThirdPartyAdapter`æ¥å£æ”¯æŒå…¶ä»–åè®®

### çƒ­åˆ‡æ¢ä½¿ç”¨

```csharp
// è·å–é€‚é…å™¨ç®¡ç†å™¨
var adapterManager = serviceProvider.GetService<IAdapterManager<IDwsAdapter>>();

// è¿è¡Œæ—¶åˆ‡æ¢åˆ°å…¶ä»–é€‚é…å™¨ï¼ˆæ— éœ€é‡å¯æœåŠ¡ï¼‰
await adapterManager.SwitchAdapterAsync("OtherVendor-DWS");

// è·å–å½“å‰æ´»åŠ¨çš„é€‚é…å™¨
var currentAdapter = adapterManager.GetActiveAdapter();

// è·å–æ‰€æœ‰å¯ç”¨é€‚é…å™¨
var allAdapters = adapterManager.GetAllAdapters();
```

## æµ‹è¯•

ç³»ç»ŸåŒ…å«å®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
dotnet test

# è¿è¡Œç‰¹å®šæµ‹è¯•
dotnet test --filter "FullyQualifiedName~RuleEngineServiceTests"
```

**æµ‹è¯•è¦†ç›–**ï¼š
- âœ… è§„åˆ™å¼•æ“æœåŠ¡æµ‹è¯•ï¼ˆé‡é‡æ¡ä»¶ã€æ¡ç åŒ¹é…ã€ç¼“å­˜ã€ä¼˜å…ˆçº§ï¼‰
- âœ… Mockå¯¹è±¡æ”¯æŒï¼ˆä½¿ç”¨Moqæ¡†æ¶ï¼‰
- ğŸ”œ æ›´å¤šæœåŠ¡å’Œé€‚é…å™¨æµ‹è¯•æ­£åœ¨å¼€å‘ä¸­

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°è§„åˆ™ç±»å‹

1. åœ¨`RuleEngineService.cs`ä¸­æ·»åŠ æ–°çš„è¯„ä¼°æ–¹æ³•
2. æ›´æ–°æ–‡æ¡£è¯´æ˜æ–°çš„è¡¨è¾¾å¼è¯­æ³•

### æ‰©å±•æŒä¹…åŒ–å±‚

1. å®ç°ç›¸åº”çš„Repositoryæ¥å£
2. åœ¨`Program.cs`ä¸­æ³¨å†Œæ–°çš„å®ç°
3. ä½¿ç”¨EF Coreåˆ›å»ºæ–°è¿ç§»ï¼š
   ```bash
   dotnet ef migrations add YourMigrationName --project ZakYip.Sorting.RuleEngine.Infrastructure --context MySqlLogDbContext
   ```

### æ·»åŠ æ–°çš„åˆ†æ‹£æœºé€‚é…å™¨

1. å®ç°`ISorterAdapter`æ¥å£ï¼š
   ```csharp
   public class CustomSorterAdapter : ISorterAdapter
   {
       public string AdapterName => "CustomVendor";
       public string ProtocolType => "CustomProtocol";
       
       public async Task<bool> SendChuteNumberAsync(string parcelId, string chuteNumber, CancellationToken cancellationToken)
       {
           // å®ç°è‡ªå®šä¹‰åè®®
       }
   }
   ```

2. åœ¨`Program.cs`ä¸­æ³¨å†Œé€‚é…å™¨

### æ·»åŠ æ–°çš„DWSé€‚é…å™¨

1. å®ç°`IDwsAdapter`æ¥å£ï¼š
   ```csharp
   public class CustomDwsAdapter : IDwsAdapter
   {
       public string AdapterName => "CustomVendor-DWS";
       public string ProtocolType => "TCP";
       
       public event Func<DwsData, Task>? OnDwsDataReceived;
       
       public async Task StartAsync(CancellationToken cancellationToken)
       {
           // å®ç°å¯åŠ¨é€»è¾‘
       }
       
       public async Task StopAsync(CancellationToken cancellationToken)
       {
           // å®ç°åœæ­¢é€»è¾‘
       }
   }
   ```

2. åœ¨Program.csä¸­æ³¨å†Œé€‚é…å™¨åˆ°AdapterManager

### æ·»åŠ æ–°çš„ç¬¬ä¸‰æ–¹APIé€‚é…å™¨

1. å®ç°`IThirdPartyAdapter`æ¥å£ï¼š
   ```csharp
   public class CustomApiAdapter : IThirdPartyAdapter
   {
       public string AdapterName => "CustomAPI";
       public string ProtocolType => "HTTP";
       
       public async Task<ThirdPartyResponse> CallApiAsync(ParcelInfo parcelInfo, DwsData dwsData, CancellationToken cancellationToken)
       {
           // å®ç°è‡ªå®šä¹‰APIè°ƒç”¨
       }
   }
   ```

2. åœ¨ä¾èµ–æ³¨å…¥ä¸­æ³¨å†Œé€‚é…å™¨

### æŸ¥è¯¢é€šä¿¡æ—¥å¿—

é€šä¿¡æ—¥å¿—å­˜å‚¨åœ¨`communication_logs`è¡¨ä¸­ï¼Œå¯ä»¥é€šè¿‡ICommunicationLogRepositoryæŸ¥è¯¢ï¼š

```csharp
// è·å–æœ€è¿‘çš„é€šä¿¡æ—¥å¿—
var logs = await communicationLogRepository.GetLogsAsync(
    startTime: DateTime.UtcNow.AddHours(-1),
    type: CommunicationType.Tcp,
    parcelId: "PKG001",
    maxRecords: 100);

// éå†æ—¥å¿—
foreach (var log in logs)
{
    Console.WriteLine($"{log.CreatedAt}: {log.Direction} {log.Message}");
    if (!log.IsSuccess)
    {
        Console.WriteLine($"  é”™è¯¯: {log.ErrorMessage}");
    }
}

### è‡ªå®šä¹‰ç¬¬ä¸‰æ–¹API

1. å®ç°`IThirdPartyApiClient`æ¥å£
2. åœ¨ä¾èµ–æ³¨å…¥ä¸­æ›¿æ¢é»˜è®¤å®ç°

### é…ç½®ç¼“å­˜æ¸…é™¤

å½“è§„åˆ™é…ç½®æ›´æ–°æ—¶ï¼Œæ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ï¼š

```csharp
// åœ¨RuleControllerä¸­
public async Task<IActionResult> UpdateRule([FromBody] SortingRule rule)
{
    await _ruleRepository.UpdateAsync(rule);
    
    // æ¸…é™¤ç¼“å­˜ä»¥é‡æ–°åŠ è½½è§„åˆ™
    if (_ruleEngineService is RuleEngineService service)
    {
        service.ClearCache();
    }
    
    return Ok();
}
```

## æœ€æ–°å®ç°åŠŸèƒ½ (v1.9.0)

### æ–°å¢åŠŸèƒ½

#### 1. ç”˜ç‰¹å›¾æ•°æ®æŸ¥è¯¢APIï¼ˆæ–°å¢ï¼‰
- âœ… **GanttChartController** - ç”˜ç‰¹å›¾æ•°æ®æŸ¥è¯¢æ¥å£
  - `GET /api/ganttchart/{target}` - æŸ¥è¯¢æŒ‡å®šåŒ…è£¹å‰åNæ¡æ•°æ®
  - `POST /api/ganttchart/query` - POSTæ–¹å¼æŸ¥è¯¢ï¼ˆæ”¯æŒå¤æ‚å‚æ•°ï¼‰
  - æ”¯æŒæŸ¥è¯¢å‰åå„100æ¡æ•°æ®èŒƒå›´
  - è‡ªåŠ¨å…³è”åŒ¹é…æ—¥å¿—ã€DWSé€šä¿¡ã€APIé€šä¿¡ã€æ ¼å£ä¿¡æ¯
  - æ”¯æŒMySQLå’ŒSQLiteåŒæ•°æ®åº“æŸ¥è¯¢
- âœ… **GanttChartDataItem** - ç”˜ç‰¹å›¾æ•°æ®é¡¹DTO
  - åŒ…å«åŒ…è£¹ä¿¡æ¯ã€åŒ¹é…ä¿¡æ¯ã€é€šä¿¡æ—¶é—´ã€æ ¼å£ä¿¡æ¯ç­‰
  - æ”¯æŒæ—¶é—´çº¿å¯è§†åŒ–å±•ç¤º
  - æ ‡è®°ç›®æ ‡åŒ…è£¹å’Œåºåˆ—å·
- âœ… **IGanttChartService** - ç”˜ç‰¹å›¾æœåŠ¡æ¥å£å’Œå®ç°
  - æ™ºèƒ½æŸ¥è¯¢ç›®æ ‡åŒ…è£¹å‰åæ•°æ®
  - è‡ªåŠ¨é™çº§å¤„ç†ï¼ˆMySQL â†’ SQLiteï¼‰

#### 2. è§„åˆ™å®‰å…¨éªŒè¯ï¼ˆæ–°å¢ï¼‰
- âœ… **RuleValidationService** - è§„åˆ™éªŒè¯æœåŠ¡
  - é˜²æ­¢ä»£ç æ³¨å…¥æ”»å‡»
  - æ£€æŸ¥å±é™©å…³é”®å­—ï¼ˆevalã€execã€systemã€scriptç­‰ï¼‰
  - éªŒè¯è¡¨è¾¾å¼æ ¼å¼å’Œé•¿åº¦é™åˆ¶
  - æ”¯æŒæŒ‰åŒ¹é…æ–¹æ³•ç±»å‹éªŒè¯è¡¨è¾¾å¼
  - ä¼˜å…ˆçº§èŒƒå›´éªŒè¯ï¼ˆ0-9999ï¼‰
- âœ… **è§„åˆ™æ§åˆ¶å™¨é›†æˆ** - RuleControllerè‡ªåŠ¨éªŒè¯
  - æ–°å¢è§„åˆ™æ—¶è‡ªåŠ¨éªŒè¯å®‰å…¨æ€§
  - æ›´æ–°è§„åˆ™æ—¶è‡ªåŠ¨éªŒè¯å®‰å…¨æ€§
  - éªŒè¯å¤±è´¥è¿”å›è¯¦ç»†é”™è¯¯ä¿¡æ¯

#### 3. APIè¯·æ±‚æ—¥å¿—è®°å½•ï¼ˆæ–°å¢ï¼‰
- âœ… **ApiRequestLogå®ä½“** - APIè¯·æ±‚æ—¥å¿—è¡¨
  - è®°å½•è¯·æ±‚æ—¶é—´ã€IPã€æ–¹æ³•ã€è·¯å¾„ã€æŸ¥è¯¢å­—ç¬¦ä¸²
  - è®°å½•è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ï¼ˆæœ€å¤§10KBï¼‰
  - è®°å½•å“åº”æ—¶é—´ã€çŠ¶æ€ç ã€å“åº”å¤´ã€å“åº”ä½“
  - è®°å½•è€—æ—¶ã€ç”¨æˆ·æ ‡è¯†ã€æˆåŠŸçŠ¶æ€
- âœ… **ApiRequestLoggingMiddleware** - è¯·æ±‚æ—¥å¿—ä¸­é—´ä»¶
  - è‡ªåŠ¨è®°å½•æ‰€æœ‰APIè¯·æ±‚
  - è·³è¿‡å¥åº·æ£€æŸ¥ã€Swaggerã€SignalRç«¯ç‚¹
  - æ”¯æŒMySQLå’ŒSQLiteåŒæ•°æ®åº“
  - æ•è·è¯·æ±‚å’Œå“åº”å®Œæ•´ä¿¡æ¯
  - è®¡ç®—ç²¾ç¡®è€—æ—¶
- âœ… **æ•°æ®åº“é›†æˆ** - MySQLå’ŒSQLiteéƒ½æ”¯æŒ
  - è‡ªåŠ¨åˆ›å»ºapi_request_logsè¡¨
  - ä¼˜åŒ–çš„ç´¢å¼•è®¾è®¡ï¼ˆæ—¶é—´ã€è·¯å¾„ã€IPã€æ–¹æ³•ï¼‰

#### 4. å…¨å±€æ¨¡å‹éªŒè¯ï¼ˆæ–°å¢ï¼‰
- âœ… **ModelValidationFilter** - å…¨å±€éªŒè¯è¿‡æ»¤å™¨
  - è‡ªåŠ¨éªŒè¯æ‰€æœ‰APIè¯·æ±‚å‚æ•°
  - ModelStateè‡ªåŠ¨æ£€æŸ¥
  - ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- âœ… **SortingRuleéªŒè¯ç‰¹æ€§** - å®ä½“çº§éªŒè¯
  - Requiredã€StringLengthã€Rangeç­‰ç‰¹æ€§
  - è§„åˆ™IDã€åç§°ã€è¡¨è¾¾å¼å¿…å¡«éªŒè¯
  - é•¿åº¦é™åˆ¶éªŒè¯
  - ä¼˜å…ˆçº§èŒƒå›´éªŒè¯

#### 5. æ¶æ„ä¼˜åŒ–ï¼ˆæ”¹è¿›ï¼‰
- âœ… **ç§»é™¤ThirdPartyResponseReceivedEvent**
  - åˆ é™¤ä¸å¿…è¦çš„äº‹ä»¶å®šä¹‰å’Œå¤„ç†å™¨
  - ç®€åŒ–ç¬¬ä¸‰æ–¹APIè°ƒç”¨æµç¨‹
  - ç›´æ¥åœ¨DwsDataReceivedEventHandlerä¸­è®°å½•å“åº”
  - å‡å°‘äº‹ä»¶ä¼ æ’­å¼€é”€
- âœ… **ä¸­å¤®åŒ…ç®¡ç†æ›´æ–°**
  - æ–°å¢Microsoft.AspNetCore.Http.Abstractions
  - æ–°å¢Microsoft.AspNetCore.Http
  - æ–°å¢Microsoft.AspNetCore.Mvc.Core
  - ç»Ÿä¸€ç®¡ç†ASP.NET Coreç›¸å…³åŒ…

## æœ€æ–°å®ç°åŠŸèƒ½ (v1.8.0)

### æ–°å¢åŠŸèƒ½

#### 1. NLogæ—¥å¿—æ¡†æ¶é›†æˆï¼ˆæ–°å¢ï¼‰
- âœ… **NLog 5.3.4** - é«˜æ€§èƒ½æ—¥å¿—æ¡†æ¶
  - å®Œæ•´çš„nlog.configé…ç½®æ–‡ä»¶
  - æ”¯æŒå¤šç§æ—¥å¿—ç›®æ ‡ï¼šæ§åˆ¶å°ã€æ–‡ä»¶ã€é”™è¯¯æ—¥å¿—ã€æ€§èƒ½æ—¥å¿—
  - è‡ªåŠ¨æ—¥å¿—è½®è½¬å’Œå½’æ¡£ï¼ˆ7-30å¤©ä¿ç•™æœŸï¼‰
  - æ—¥å¿—çº§åˆ«è¿‡æ»¤å’Œåˆ†ç±»
  - UTF-8ç¼–ç æ”¯æŒ

#### 2. Newtonsoft.Jsoné›†æˆï¼ˆæ–°å¢ï¼‰
- âœ… **Newtonsoft.Json 13.0.3** - JSONåºåˆ—åŒ–åº“
  - Microsoft.AspNetCore.Mvc.NewtonsoftJsoné›†æˆ
  - é…ç½®å¾ªç¯å¼•ç”¨å¤„ç†
  - ç©ºå€¼å¿½ç•¥é€‰é¡¹
  - æ ‡å‡†åŒ–æ—¥æœŸæ ¼å¼ï¼ˆyyyy-MM-dd HH:mm:ssï¼‰

#### 3. æ¡ä»¶WindowsæœåŠ¡æ”¯æŒï¼ˆæ”¹è¿›ï¼‰
- âœ… **æ¡ä»¶ç¼–è¯‘** - ä»…Releaseæ¨¡å¼ä½¿ç”¨WindowsæœåŠ¡
  - DEBUGæ¨¡å¼ä¸‹ä½œä¸ºæ§åˆ¶å°åº”ç”¨è¿è¡Œ
  - ä½¿ç”¨#if !DEBUGæ¡ä»¶ç¼–è¯‘æŒ‡ä»¤
  - ä¾¿äºå¼€å‘è°ƒè¯•

#### 4. KestrelæœåŠ¡å™¨é…ç½®ï¼ˆæ–°å¢ï¼‰
- âœ… **Kestrelä¼˜åŒ–é…ç½®** - ASP.NET Core WebæœåŠ¡å™¨
  - æœ€å¤§å¹¶å‘è¿æ¥æ•°ï¼š1000
  - è¯·æ±‚ä½“å¤§å°é™åˆ¶ï¼š10MB
  - Keep-Aliveè¶…æ—¶ï¼š2åˆ†é’Ÿ
  - è¯·æ±‚å¤´è¶…æ—¶ï¼š30ç§’
  - å…³é—­Serverå¤´ä»¥æé«˜å®‰å…¨æ€§

#### 5. ç¬¬ä¸‰æ–¹APIæ•°æ®åº“é…ç½®ï¼ˆæ–°å¢ï¼‰
- âœ… **ThirdPartyApiConfigå®ä½“** - ä½¿ç”¨record class
  - æ”¯æŒå¤šä¸ªç¬¬ä¸‰æ–¹APIé…ç½®
  - å­˜å‚¨åœ¨LiteDBä¸­
  - å¯é…ç½®ä¼˜å…ˆçº§ã€è¶…æ—¶ã€è‡ªå®šä¹‰å¤´ç­‰
  - æ”¯æŒHTTPæ–¹æ³•å’Œè¯·æ±‚ä½“æ¨¡æ¿
- âœ… **ThirdPartyApiConfigController** - å®Œæ•´CRUD API
  - `GET /api/thirdpartyapiconfig` - è·å–æ‰€æœ‰é…ç½®
  - `GET /api/thirdpartyapiconfig/enabled` - è·å–å¯ç”¨çš„é…ç½®
  - `POST /api/thirdpartyapiconfig` - åˆ›å»ºé…ç½®
  - `PUT /api/thirdpartyapiconfig/{id}` - æ›´æ–°é…ç½®
  - `DELETE /api/thirdpartyapiconfig/{id}` - åˆ é™¤é…ç½®

#### 6. SignalRå®¢æˆ·ç«¯æœåŠ¡ï¼ˆæ–°å¢ï¼‰
- âœ… **SignalRClientService** - æ”¯æŒè‡ªåŠ¨é‡è¿
  - å¿«é€Ÿé‡è¿ç­–ç•¥ï¼ˆ0ms, 100ms, 500ms, 1s, 2sï¼‰
  - è¿æ¥çŠ¶æ€å˜åŒ–äº‹ä»¶
  - çº¿ç¨‹å®‰å…¨çš„è¿æ¥ç®¡ç†
  - æ–¹æ³•è°ƒç”¨å’Œäº‹ä»¶è®¢é˜…
  - å®ç°IAsyncDisposable

#### 7. TCPå®¢æˆ·ç«¯æœåŠ¡ï¼ˆæ–°å¢ï¼‰
- âœ… **TcpClientService** - æ”¯æŒè‡ªåŠ¨é‡è¿
  - è‡ªåŠ¨é‡è¿å¾ªç¯ï¼ˆæœ€é•¿2ç§’é—´éš”ï¼‰
  - æ•°æ®æ¥æ”¶äº‹ä»¶
  - è¿æ¥çŠ¶æ€å˜åŒ–äº‹ä»¶
  - å‘é€æ–‡æœ¬å’Œå­—èŠ‚æ•°æ®
  - å®ç°IAsyncDisposable

#### 8. äº‹ä»¶è½½è·ä¼˜åŒ–ï¼ˆæ”¹è¿›ï¼‰
- âœ… **æ‰€æœ‰äº‹ä»¶æ”¹ä¸ºrecord class** - å€¼è¯­ä¹‰
  - ParcelCreatedEvent
  - DwsDataReceivedEvent
  - ThirdPartyResponseReceivedEvent
  - RuleMatchCompletedEvent
  - ä½¿ç”¨requiredå…³é”®å­—è€Œéæ„é€ å‡½æ•°

#### 9. æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼ˆæ–°å¢ï¼‰
- âœ… **ZakYip.Sorting.RuleEngine.Benchmarksé¡¹ç›®** - BenchmarkDotNetæ¡†æ¶
  - RuleMatchingBenchmarks - 7ä¸ªåŸºå‡†æµ‹è¯•
    - æ¡ç åŒ¹é…ï¼ˆStartsWith, Contains, Regexï¼‰
    - é‡é‡åŒ¹é…ï¼ˆç®€å•ã€å¤æ‚è¡¨è¾¾å¼ï¼‰
    - ä½“ç§¯åŒ¹é…ï¼ˆç®€å•ã€å¤æ‚è¡¨è¾¾å¼ï¼‰
  - å†…å­˜è¯Šæ–­å’Œæ€§èƒ½æ’å
  - å¯æ‰©å±•çš„åŸºå‡†æµ‹è¯•æ¶æ„

#### 10. æ€§èƒ½ä¼˜åŒ–ç‰¹æ€§ï¼ˆæ”¹è¿›ï¼‰
- âœ… **MethodImplç‰¹æ€§** - æè‡´æ€§èƒ½ä¼˜åŒ–
  - SignalRClientServiceä½¿ç”¨AggressiveInlining
  - TcpClientServiceä½¿ç”¨AggressiveInlining
  - å…³é”®è·¯å¾„æ–¹æ³•å†…è”ä¼˜åŒ–

## å†å²ç‰ˆæœ¬åŠŸèƒ½ (v1.7.0)

### æ–°å¢åŠŸèƒ½

#### 1. ç‰ˆæœ¬ä¿¡æ¯æŸ¥è¯¢ï¼ˆæ–°å¢ï¼‰
- âœ… **ç‰ˆæœ¬ä¿¡æ¯API** - é€šè¿‡HTTPæŸ¥è¯¢ç³»ç»Ÿç‰ˆæœ¬
  - `/api/version` - è¿”å›ç³»ç»Ÿç‰ˆæœ¬ã€æ„å»ºæ—¥æœŸç­‰ä¿¡æ¯
  - æ”¯æŒSignalR HubæŸ¥è¯¢ç‰ˆæœ¬ï¼ˆSortingHubã€DwsHubçš„GetVersionæ–¹æ³•ï¼‰
  - ç‰ˆæœ¬å·ï¼š1.7.0

#### 2. æ—¥å¿—æ–‡ä»¶è‡ªåŠ¨æ¸…ç†ï¼ˆæ–°å¢ï¼‰
- âœ… **LogFileCleanupService** - åå°æœåŠ¡å®šæœŸæ¸…ç†.logæ–‡ä»¶
  - å¯é…ç½®ä¿ç•™å¤©æ•°ï¼ˆé»˜è®¤7å¤©ï¼‰
  - å¯é…ç½®æ—¥å¿—ç›®å½•ï¼ˆé»˜è®¤./logsï¼‰
  - æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼Œè‡ªåŠ¨åˆ é™¤è¿‡æœŸæ–‡ä»¶
  - åœ¨appsettings.jsonä¸­é…ç½®LogFileCleanupèŠ‚

#### 3. é…ç½®æ–‡ä»¶ä¸­æ–‡æ³¨é‡Šï¼ˆæ–°å¢ï¼‰
- âœ… **appsettings.jsonå®Œæ•´ä¸­æ–‡æ³¨é‡Š** - æ‰€æœ‰é…ç½®å­—æ®µéƒ½æœ‰è¯¦ç»†ä¸­æ–‡æ³¨é‡Š
  - LiteDBé…ç½®æ³¨é‡Š
  - MySQLé…ç½®å’Œç†”æ–­å™¨å‚æ•°æ³¨é‡Š
  - åˆ†ç‰‡ç­–ç•¥é…ç½®æ³¨é‡Š
  - APIå’Œç¼“å­˜é…ç½®æ³¨é‡Š
  - æ—¥å¿—æ¸…ç†é…ç½®æ³¨é‡Š

#### 4. æšä¸¾ä½¿ç”¨é‡æ„ï¼ˆæ–°å¢ï¼‰
- âœ… **BarcodeRegexMatcheré‡æ„** - æ”¯æŒæšä¸¾ç±»å‹åŒ¹é…
  - æ–°å¢æšä¸¾å‚æ•°æ–¹æ³•ï¼š`Evaluate(BarcodeMatchPreset preset, string parameter, string barcode)`
  - ä¿æŒå‘åå…¼å®¹çš„å­—ç¬¦ä¸²è¡¨è¾¾å¼æ–¹æ³•
  - ä½¿ç”¨BarcodeMatchPresetæšä¸¾
- âœ… **ApiResponseMatcheré‡æ„** - æ”¯æŒæšä¸¾ç±»å‹åŒ¹é…
  - æ–°å¢æšä¸¾å‚æ•°æ–¹æ³•ï¼š`Evaluate(ApiResponseMatchType matchType, string parameter, string responseData)`
  - ä¿æŒå‘åå…¼å®¹çš„å­—ç¬¦ä¸²è¡¨è¾¾å¼æ–¹æ³•
  - ä½¿ç”¨ApiResponseMatchTypeæšä¸¾

#### 5. æ ¼å£ç®¡ç†APIï¼ˆæ–°å¢ï¼‰
- âœ… **ChuteController** - å®Œæ•´çš„æ ¼å£CRUD API
  - `GET /api/chute` - è·å–æ‰€æœ‰æ ¼å£
  - `GET /api/chute/{id}` - æ ¹æ®IDè·å–æ ¼å£
  - `GET /api/chute/code/{code}` - æ ¹æ®ç¼–å·è·å–æ ¼å£
  - `GET /api/chute/enabled` - è·å–æ‰€æœ‰å¯ç”¨çš„æ ¼å£
  - `POST /api/chute` - åˆ›å»ºæ ¼å£
  - `PUT /api/chute/{id}` - æ›´æ–°æ ¼å£
  - `DELETE /api/chute/{id}` - åˆ é™¤æ ¼å£
- âœ… **IChuteRepositoryæ¥å£å’Œå®ç°** - LiteDBæ ¼å£ä»“å‚¨

#### 6. æ—¥å¿—æŸ¥è¯¢å’Œå¯¼å‡ºAPIï¼ˆæ–°å¢ï¼‰
- âœ… **LogController** - ä¸“ç”¨æ—¥å¿—è¡¨æŸ¥è¯¢API
  - `GET /api/log/matching` - æŸ¥è¯¢åŒ¹é…æ—¥å¿—ï¼Œæ”¯æŒåˆ†é¡µå’Œæ—¶é—´è¿‡æ»¤
  - `GET /api/log/dws-communication` - æŸ¥è¯¢DWSé€šä¿¡æ—¥å¿—
  - `GET /api/log/api-communication` - æŸ¥è¯¢APIé€šä¿¡æ—¥å¿—
  - `GET /api/log/sorter-communication` - æŸ¥è¯¢åˆ†æ‹£æœºé€šä¿¡æ—¥å¿—
  - `GET /api/log/matching/export` - å¯¼å‡ºåŒ¹é…æ—¥å¿—ä¸ºCSVï¼ˆæœ€å¤š10000æ¡ï¼‰
  - æ”¯æŒæŒ‰æ—¶é—´èŒƒå›´ã€åŒ…è£¹IDã€æ¡ç ç­‰æ¡ä»¶æŸ¥è¯¢

#### 7. æ—¥å¿—å½’æ¡£ç­–ç•¥ï¼ˆå·²æœ‰ï¼‰
- âœ… **DataArchiveService** - å·²å®ç°æ•°æ®å½’æ¡£æœåŠ¡
  - åœ¨appsettings.jsonä¸­é…ç½®ArchiveScheduleï¼ˆé»˜è®¤æ¯å¤©å‡Œæ™¨3ç‚¹ï¼‰
  - å†·æ•°æ®é˜ˆå€¼é…ç½®ï¼ˆé»˜è®¤30å¤©ï¼‰
  - è‡ªåŠ¨ç»Ÿè®¡å’Œå½’æ¡£å†·æ•°æ®

## å†å²ç‰ˆæœ¬åŠŸèƒ½ (v1.6.0)

### å·²å®ç°åŠŸèƒ½

#### 1. æšä¸¾ç±»å‹å®šä¹‰
- âœ… **BarcodeMatchPresetæšä¸¾** - å®šä¹‰æ¡ç åŒ¹é…é¢„è®¾ç±»å‹
  - StartsWith - ä»¥æŒ‡å®šå­—ç¬¦ä¸²å¼€å¤´
  - Contains - åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²
  - NotContains - ä¸åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²
  - AllDigits - å…¨æ•°å­—
  - Alphanumeric - å­—æ¯å’Œæ•°å­—ç»„åˆ
  - Length - æŒ‡å®šé•¿åº¦èŒƒå›´
  - Regex - è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼
- âœ… **ApiResponseMatchTypeæšä¸¾** - å®šä¹‰APIå“åº”åŒ¹é…ç±»å‹
  - String - å­—ç¬¦ä¸²æŸ¥æ‰¾ï¼ˆæ­£å‘ï¼‰
  - StringReverse - å­—ç¬¦ä¸²æŸ¥æ‰¾ï¼ˆåå‘ï¼‰
  - Regex - æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…
  - Json - JSONå­—æ®µåŒ¹é…

#### 2. æ ¼å£ç®¡ç†
- âœ… **Chuteå®ä½“** - æ ¼å£ä¿¡æ¯ç®¡ç†
  - ChuteId (long) - æ ¼å£IDï¼Œè‡ªå¢ä¸»é”®
  - ChuteName - æ ¼å£åç§°
  - ChuteCode - æ ¼å£ç¼–å·ï¼ˆå¯é€‰ï¼‰
  - Description - æ ¼å£æè¿°
  - IsEnabled - æ˜¯å¦å¯ç”¨
  - CreatedAt/UpdatedAt - åˆ›å»º/æ›´æ–°æ—¶é—´
- âœ… æ•°æ®åº“è¡¨å’Œç´¢å¼•é…ç½®
- âœ… æ”¯æŒMySQLå’ŒSQLiteåŒæ•°æ®åº“

#### 3. ä¸“ç”¨é€šä¿¡æ—¥å¿—è¡¨
- âœ… **SorterCommunicationLog** - åˆ†æ‹£æœºé€šä¿¡æ—¥å¿—
  - åˆ†æ‹£æœºåœ°å€ã€é€šä¿¡ç±»å‹ï¼ˆæ¥æ”¶/å‘é€ï¼‰
  - åŸå§‹å†…å®¹ã€æ ¼å¼åŒ–å†…å®¹
  - æå–çš„åŒ…è£¹IDã€å°è½¦å·ï¼ˆæ¥æ”¶æ—¶ï¼‰
  - é€šä¿¡æ—¶é—´ã€æˆåŠŸçŠ¶æ€ã€é”™è¯¯ä¿¡æ¯
- âœ… **DwsCommunicationLog** - DWSé€šä¿¡æ—¥å¿—
  - DWSåœ°å€ã€åŸå§‹å†…å®¹ã€æ ¼å¼åŒ–å†…å®¹
  - æ¡ç ã€é‡é‡ã€ä½“ç§¯
  - é€šä¿¡æ—¶é—´ã€æˆåŠŸçŠ¶æ€ã€é”™è¯¯ä¿¡æ¯
- âœ… **ApiCommunicationLog** - APIé€šä¿¡æ—¥å¿—
  - åŒ…è£¹IDã€è¯·æ±‚åœ°å€ã€è¯·æ±‚/å“åº”å†…å®¹
  - è¯·æ±‚/å“åº”å¤´ã€çŠ¶æ€ç 
  - è¯·æ±‚æ—¶é—´ã€è€—æ—¶ã€å“åº”æ—¶é—´
  - æ ¼å¼åŒ–çš„Curlå†…å®¹
- âœ… **MatchingLog** - åŒ¹é…æ—¥å¿—
  - åŒ…è£¹IDã€å…³è”çš„DWS/APIå†…å®¹
  - åŒ¹é…çš„è§„åˆ™IDã€åŒ¹é…ä¾æ®
  - æ ¼å£IDã€å°è½¦å ä½æ•°é‡
  - åŒ¹é…æ—¶é—´ã€æˆåŠŸçŠ¶æ€ã€é”™è¯¯ä¿¡æ¯

#### 4. æ•°æ®åº“ä¼˜åŒ–
- âœ… æ‰€æœ‰è¡¨çš„IDå­—æ®µç»Ÿä¸€ä½¿ç”¨longç±»å‹ï¼ˆè‡ªå¢ä¸»é”®ï¼‰
- âœ… ä¸ºæ‰€æœ‰æ—¥å¿—è¡¨åˆ›å»ºäº†åˆé€‚çš„ç´¢å¼•
  - æŒ‰æ—¶é—´é™åºç´¢å¼•ï¼Œä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½
  - æŒ‰å…³é”®å­—æ®µç´¢å¼•ï¼ˆåŒ…è£¹IDã€æ¡ç ã€æ ¼å£IDç­‰ï¼‰
- âœ… æ”¯æŒMySQLå’ŒSQLiteåŒæ•°æ®åº“
- âœ… è‡ªåŠ¨åˆ›å»ºEF Coreæ•°æ®åº“è¿ç§»

## å†å²ç‰ˆæœ¬åŠŸèƒ½ (v1.5.0)

### å·²å®ç°åŠŸèƒ½

#### 1. æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œç›‘æ§
- âœ… åˆ›å»ºæ€§èƒ½æŒ‡æ ‡å®ä½“ï¼ˆPerformanceMetricï¼‰
- âœ… åˆ›å»ºæ€§èƒ½æŒ‡æ ‡ä»“å‚¨æ¥å£ï¼ˆIPerformanceMetricRepositoryï¼‰
- âœ… åˆ›å»ºæ€§èƒ½æŒ‡æ ‡æ”¶é›†æœåŠ¡ï¼ˆPerformanceMetricServiceï¼‰
- âœ… é›†æˆåˆ°è§„åˆ™å¼•æ“æœåŠ¡ï¼Œè‡ªåŠ¨æ”¶é›†è§„åˆ™è¯„ä¼°æ€§èƒ½
- âœ… æ”¯æŒP50/P95/P99å»¶è¿Ÿç»Ÿè®¡
- âœ… è¯¦ç»†æ–‡æ¡£ï¼š[PERFORMANCE_METRICS.md](./PERFORMANCE_METRICS.md)

#### 2. å¤šç§åŒ¹é…æ–¹æ³•
- âœ… **æ¡ç æ­£åˆ™åŒ¹é…** (BarcodeRegexMatcher)
  - æ”¯æŒé¢„è®¾é€‰é¡¹ï¼šSTARTSWITHã€CONTAINSã€NOTCONTAINSã€ALLDIGITSã€ALPHANUMERICã€LENGTH
  - æ”¯æŒè‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼
- âœ… **é‡é‡åŒ¹é…** (WeightMatcher)
  - æ”¯æŒè¡¨è¾¾å¼ï¼š>ã€=ã€<ã€&/andã€|/or
- âœ… **ä½“ç§¯åŒ¹é…** (VolumeMatcher)
  - æ”¯æŒLengthã€Widthã€Heightã€Volumeçš„å¤æ‚è¡¨è¾¾å¼
- âœ… **OCRåŒ¹é…** (OcrMatcher)
  - æ”¯æŒåœ°å€æ®µç åŒ¹é…ï¼ˆä¸‰æ®µç ã€ç¬¬ä¸€/äºŒ/ä¸‰æ®µç ï¼‰
  - æ”¯æŒæ”¶ä»¶äºº/å¯„ä»¶äººåœ°å€å’Œç”µè¯åç¼€åŒ¹é…
- âœ… **APIå“åº”å†…å®¹åŒ¹é…** (ApiResponseMatcher)
  - å­—ç¬¦ä¸²æŸ¥æ‰¾ï¼ˆæ­£å‘/åå‘ï¼‰
  - æ­£åˆ™æŸ¥æ‰¾
  - JSONåŒ¹é…ï¼ˆæ”¯æŒåµŒå¥—å­—æ®µï¼‰
- âœ… **ä½ä»£ç è¡¨è¾¾å¼åŒ¹é…** (LowCodeExpressionMatcher)
  - æ”¯æŒæ··åˆä½¿ç”¨å¤šç§æ¡ä»¶
  - çµæ´»çš„è‡ªå®šä¹‰è¡¨è¾¾å¼
- âœ… è¯¦ç»†æ–‡æ¡£ï¼š[MATCHING_METHODS.md](./MATCHING_METHODS.md)

#### 3. å¤šè§„åˆ™åŒ¹é…æ”¯æŒ
- âœ… ä¸€ä¸ªæ ¼å£IDå¯ä»¥åŒ¹é…å¤šæ¡è§„åˆ™
- âœ… ç³»ç»Ÿæ”¶é›†æ‰€æœ‰åŒ¹é…çš„è§„åˆ™
- âœ… æŒ‰ä¼˜å…ˆçº§è¿”å›æœ€é«˜ä¼˜å…ˆçº§è§„åˆ™çš„æ ¼å£å·
- âœ… è®°å½•åŒ¹é…åˆ°çš„è§„åˆ™æ•°é‡

#### 4. å®Œå–„çš„å•å…ƒæµ‹è¯•
- âœ… BarcodeRegexMatcherTests - æ¡ç æ­£åˆ™åŒ¹é…æµ‹è¯•
- âœ… WeightMatcherTests - é‡é‡åŒ¹é…æµ‹è¯•
- âœ… VolumeMatcherTests - ä½“ç§¯åŒ¹é…æµ‹è¯•
- âœ… OcrMatcherTests - OCRåŒ¹é…æµ‹è¯•
- âœ… ApiResponseMatcherTests - APIå“åº”åŒ¹é…æµ‹è¯•
- âœ… æ€»è®¡70ä¸ªå•å…ƒæµ‹è¯•ï¼Œå…¨éƒ¨é€šè¿‡

## å†å²ç‰ˆæœ¬åŠŸèƒ½ (v1.4.0)

### å·²å®ç°çš„åŠŸèƒ½

#### 1. SignalR Hubå®ç°ï¼ˆæ–°å¢ï¼‰
- âœ… åˆ›å»ºSortingHubç”¨äºåˆ†æ‹£æœºå®æ—¶é€šä¿¡ï¼ˆ/hubs/sortingï¼‰
- âœ… åˆ›å»ºDwsHubç”¨äºDWSå®æ—¶é€šä¿¡ï¼ˆ/hubs/dwsï¼‰
- âœ… åœ¨Program.csä¸­é…ç½®SignalRæœåŠ¡
- âœ… æ”¯æŒè‡ªåŠ¨é‡è¿å’ŒåŒå‘é€šä¿¡
- âœ… ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨SignalRæˆ–TCPï¼ŒHTTPä»…ç”¨äºæµ‹è¯•

#### 2. é€šä¿¡æ–¹å¼ä¼˜åŒ–ï¼ˆæ–°å¢ï¼‰
- âœ… æ˜ç¡®åˆ†æ‹£ç¨‹åºå’ŒDWSåªä½¿ç”¨TCP/SignalRé€šä¿¡
- âœ… HTTP APIæ ‡è®°ä¸ºä»…ç”¨äºæµ‹è¯•å’Œè°ƒè¯•
- âœ… æ·»åŠ é€šä¿¡æ–¹å¼é€‰æ‹©æŒ‡å—

#### 3. TouchSocketè¿æ¥æ± ä¼˜åŒ–ï¼ˆæ–°å¢ï¼‰
- âœ… TouchSocketDwsAdapteræ·»åŠ è¿æ¥æ± é…ç½®ï¼ˆæœ€å¤§è¿æ¥æ•°ï¼šé»˜è®¤1000ï¼‰
- âœ… TouchSocketSorterAdapteræ·»åŠ è‡ªåŠ¨é‡è¿é…ç½®ï¼ˆé»˜è®¤5ç§’é—´éš”ï¼‰
- âœ… å¯é…ç½®ç¼“å†²åŒºå¤§å°ï¼ˆé»˜è®¤8192å­—èŠ‚ï¼‰
- âœ… ä¼˜åŒ–æ¶ˆæ¯å¤„ç†æ€§èƒ½

#### 4. ä»£ç è´¨é‡æ”¹è¿›ï¼ˆæ–°å¢ï¼‰
- âœ… ç§»é™¤æ‰€æœ‰è‹±æ–‡æ³¨é‡Šï¼Œç»Ÿä¸€ä½¿ç”¨ä¸­æ–‡æ³¨é‡Š
- âœ… ä¼˜åŒ–ä»£ç å¯è¯»æ€§å’Œç»´æŠ¤æ€§

#### 5. è‡ªåŠ¨æ•°æ®åº“è¿ç§»
- âœ… EF Coreè‡ªåŠ¨è¿ç§»ï¼Œéƒ¨ç½²æ—¶è‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨
- âœ… è‡ªåŠ¨åº”ç”¨è¿ç§»æ›´æ–°ï¼Œæ”¯æŒMySQLå’ŒSQLite
- âœ… åœ¨Program.csä¸­å®ç°ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œ

#### 6. é€‚é…å™¨çƒ­åˆ‡æ¢
- âœ… å®ç°IAdapterManager<T>æ¥å£ï¼Œæ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢é€‚é…å™¨
- âœ… æ”¯æŒåˆ‡æ¢DWSé€‚é…å™¨ï¼ˆä¸åŒå‚å•†ã€ä¸åŒåè®®ï¼‰
- âœ… æ”¯æŒåˆ‡æ¢åˆ†æ‹£æœºé€‚é…å™¨ï¼ˆä¸åŒå‚å•†ã€ä¸åŒåè®®ï¼‰
- âœ… æ”¯æŒåˆ‡æ¢ç¬¬ä¸‰æ–¹APIé€‚é…å™¨
- âœ… æ— éœ€é‡å¯æœåŠ¡å³å¯çƒ­åˆ‡æ¢

#### 7. TouchSocket TCPé€šä¿¡
- âœ… é›†æˆTouchSocketé«˜æ€§èƒ½TCPåº“
- âœ… å®ç°TouchSocketDwsAdapterç”¨äºDWSæ•°æ®æ¥æ”¶
- âœ… å®ç°TouchSocketSorterAdapterç”¨äºåˆ†æ‹£æœºé€šä¿¡
- âœ… æ”¯æŒè‡ªåŠ¨é‡è¿å’Œå¼‚å¸¸å¤„ç†

#### 8. é€šä¿¡æ—¥å¿—è®°å½•
- âœ… æ–°å¢CommunicationLogå®ä½“å­˜å‚¨æ‰€æœ‰é€šä¿¡æ—¥å¿—
- âœ… è®°å½•TCPã€SignalRã€HTTPé€šä¿¡çš„å…¨é‡æ—¥å¿—
- âœ… æ”¯æŒæŒ‰ç±»å‹ã€æ—¶é—´ã€åŒ…è£¹IDæŸ¥è¯¢æ—¥å¿—
- âœ… è‡ªåŠ¨è®°å½•å‘é€/æ¥æ”¶æ–¹å‘ã€æˆåŠŸ/å¤±è´¥çŠ¶æ€

#### 9. ä»£ç ç»“æ„ä¼˜åŒ–
- âœ… æ‰€æœ‰æšä¸¾ç‹¬ç«‹æ–‡ä»¶å­˜æ”¾ï¼ˆParcelStatus, WorkItemType, CommunicationTypeç­‰ï¼‰
- âœ… æ‰€æœ‰æšä¸¾æ·»åŠ Descriptionç‰¹æ€§ï¼Œä½¿ç”¨ä¸­æ–‡æè¿°
- âœ… å°†åµŒå¥—ç±»ç§»åˆ°ç‹¬ç«‹æ–‡ä»¶ï¼ˆParcelProcessingContext, ParcelWorkItemï¼‰
- âœ… ä»£ç æ³¨é‡Šç»Ÿä¸€ä½¿ç”¨ä¸­æ–‡

#### 10. æµ‹è¯•å·¥å…·
- âœ… åˆ›å»ºZakYip.Sorting.RuleEngine.TestConsoleæµ‹è¯•æ§åˆ¶å°
- âœ… æ”¯æŒæ¨¡æ‹Ÿåˆ†æ‹£æœºä¿¡å·å‘é€ï¼ˆHTTP APIï¼‰
- âœ… æ”¯æŒæ¨¡æ‹ŸDWSæ•°æ®å‘é€ï¼ˆTCPï¼‰
- âœ… æä¾›äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢

### ä¼˜åŒ–æ–¹å‘

#### çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰
1. ~~**æ ¼å£ç®¡ç†API**~~ - âœ… å·²å®Œæˆï¼ˆv1.7.0ï¼‰
2. ~~**æ—¥å¿—æŸ¥è¯¢API**~~ - âœ… å·²å®Œæˆï¼ˆv1.7.0ï¼‰
3. ~~**æšä¸¾ä½¿ç”¨é‡æ„**~~ - âœ… å·²å®Œæˆï¼ˆv1.7.0ï¼‰
4. ~~**NLogæ—¥å¿—æ¡†æ¶**~~ - âœ… å·²å®Œæˆï¼ˆv1.8.0ï¼‰
5. ~~**ç¬¬ä¸‰æ–¹APIæ•°æ®åº“é…ç½®**~~ - âœ… å·²å®Œæˆï¼ˆv1.8.0ï¼‰
6. ~~**SignalR/TCPå®¢æˆ·ç«¯æœåŠ¡**~~ - âœ… å·²å®Œæˆï¼ˆv1.8.0ï¼‰
7. ~~**æ€§èƒ½åŸºå‡†æµ‹è¯•**~~ - âœ… å·²å®Œæˆï¼ˆv1.8.0ï¼‰
8. ~~**ç”˜ç‰¹å›¾æ•°æ®æŸ¥è¯¢API**~~ - âœ… å·²å®Œæˆï¼ˆv1.9.0ï¼‰
9. ~~**è§„åˆ™å®‰å…¨éªŒè¯**~~ - âœ… å·²å®Œæˆï¼ˆv1.9.0ï¼‰
10. ~~**APIè¯·æ±‚æ—¥å¿—è®°å½•**~~ - âœ… å·²å®Œæˆï¼ˆv1.9.0ï¼‰
11. ~~**å…¨å±€æ¨¡å‹éªŒè¯**~~ - âœ… å·²å®Œæˆï¼ˆv1.9.0ï¼‰
12. ~~**å®Œæ•´æ•°æ®åº“é™çº§è¿˜åŸ**~~ - âœ… å·²å®Œæˆï¼ˆv1.11.0ï¼‰
13. **æŸ¥è¯¢APIå“åº”DTOè§„èŒƒåŒ–** - æ‰€æœ‰æŸ¥è¯¢APIç«¯ç‚¹ä½¿ç”¨æ ‡å‡†å“åº”DTOï¼ŒSwaggerå­—æ®µå¤‡æ³¨å®Œæ•´
14. **æ ¼å£åˆ†é…ä¼˜åŒ–** - åŸºäºæ ¼å£ä½¿ç”¨æƒ…å†µçš„æ™ºèƒ½åˆ†é…ç®—æ³•
15. **ç‰ˆæœ¬å‡çº§é€šçŸ¥** - å½“æœ‰æ–°ç‰ˆæœ¬æ—¶è‡ªåŠ¨é€šçŸ¥ç®¡ç†å‘˜
16. **å¼‚å¸¸éš”ç¦»å™¨** - ä¸ºæ‰€æœ‰å¯èƒ½å¼‚å¸¸çš„æ–¹æ³•æ·»åŠ Pollyç­–ç•¥
17. **å¥åº·æ£€æŸ¥å¢å¼º** - æ·»åŠ æ›´è¯¦ç»†çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼ˆæ•°æ®åº“ã€ç¼“å­˜ã€ç¬¬ä¸‰æ–¹APIç­‰ï¼‰
18. **è§„åˆ™æµ‹è¯•å·¥å…·** - æä¾›è§„åˆ™è¡¨è¾¾å¼åœ¨çº¿æµ‹è¯•å’ŒéªŒè¯å·¥å…·

#### ä¸­æœŸä¼˜åŒ–ï¼ˆ1-3ä¸ªæœˆï¼‰
1. **ç›‘æ§é¢æ¿** - å¼€å‘å®æ—¶ç›‘æ§é¢æ¿æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€å’Œæ—¥å¿—ç»Ÿè®¡
   - å®æ—¶åŒ…è£¹å¤„ç†é‡ç›‘æ§
   - æ ¼å£ä½¿ç”¨ç‡å¯è§†åŒ–
   - æ€§èƒ½æŒ‡æ ‡å›¾è¡¨å±•ç¤ºï¼ˆP50/P95/P99å»¶è¿Ÿï¼‰
   - é”™è¯¯ç‡å’Œå¼‚å¸¸ç›‘æ§
2. **æ ¼å£åˆ©ç”¨ç‡ç»Ÿè®¡** - ç»Ÿè®¡åˆ†ææ ¼å£ä½¿ç”¨æƒ…å†µå’Œåˆ†æ‹£æ•ˆç‡
3. **æ—¥å¿—å½’æ¡£ä¼˜åŒ–** - ä¼˜åŒ–æ—¥å¿—è¡¨çš„è‡ªåŠ¨å½’æ¡£å’Œæ¸…ç†æ€§èƒ½
4. **æ›´å¤šé€‚é…å™¨** - æ”¯æŒæ›´å¤šå‚å•†çš„DWSå’Œåˆ†æ‹£æœºè®¾å¤‡
   - æ›´å¤šå“ç‰Œçš„DWSè®¾å¤‡é€‚é…
   - æ›´å¤šå“ç‰Œçš„åˆ†æ‹£æœºé€‚é…
   - é€šç”¨åè®®é€‚é…å™¨ï¼ˆModbusã€OPC UAç­‰ï¼‰
5. **è´Ÿè½½å‡è¡¡** - æ”¯æŒå¤šå®ä¾‹éƒ¨ç½²å’Œè´Ÿè½½å‡è¡¡
   - Redisåˆ†å¸ƒå¼ç¼“å­˜
   - åˆ†å¸ƒå¼é”å®ç°
   - ä¼šè¯å…±äº«
6. **å‹åŠ›æµ‹è¯•é¡¹ç›®** - åˆ›å»ºä¸“é—¨çš„å‹åŠ›æµ‹è¯•é¡¹ç›®
   - æ¨¡æ‹Ÿé«˜å¹¶å‘åœºæ™¯ï¼ˆ100-1000åŒ…è£¹/ç§’ï¼‰
   - è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
   - ç”Ÿæˆæ€§èƒ½æµ‹è¯•æŠ¥å‘Š
7. **Webç®¡ç†ç•Œé¢** - å¼€å‘å®Œæ•´çš„Webç®¡ç†æ§åˆ¶å°
   - è§„åˆ™ç®¡ç†ç•Œé¢
   - æ ¼å£ç®¡ç†ç•Œé¢
   - æ—¥å¿—æŸ¥è¯¢å’Œåˆ†æç•Œé¢
   - ç³»ç»Ÿé…ç½®ç•Œé¢
8. **ä»£ç è´¨é‡ä¼˜åŒ–** 
   - doubleæ›¿æ¢ä¸ºdecimalæé«˜ç²¾åº¦
   - å¸ƒå°”å­—æ®µå‰ç¼€è§„èŒƒåŒ–ï¼ˆIs/Has/Canç­‰ï¼‰
   - ä»£ç è¦†ç›–ç‡æå‡è‡³80%ä»¥ä¸Š

#### é•¿æœŸä¼˜åŒ–ï¼ˆ3-6ä¸ªæœˆï¼‰
1. **å¾®æœåŠ¡æ¶æ„** - æ‹†åˆ†ä¸ºå¾®æœåŠ¡æ¶æ„ï¼Œæé«˜å¯æ‰©å±•æ€§
   - è§„åˆ™å¼•æ“æœåŠ¡
   - åŒ…è£¹å¤„ç†æœåŠ¡
   - é€šä¿¡ç½‘å…³æœåŠ¡
   - æ—¥å¿—æœåŠ¡
   - é…ç½®ä¸­å¿ƒ
2. **å®¹å™¨åŒ–éƒ¨ç½²** - æ”¯æŒDockerå’ŒKuberneteséƒ¨ç½²
   - Dockeré•œåƒæ„å»º
   - Kubernetesé…ç½®æ–‡ä»¶
   - Helm Charts
   - CI/CDæµæ°´çº¿
3. **AIè§„åˆ™å¼•æ“** - å¼•å…¥æœºå™¨å­¦ä¹ ä¼˜åŒ–è§„åˆ™åŒ¹é…å’Œæ ¼å£åˆ†é…
   - åŸºäºå†å²æ•°æ®çš„æ™ºèƒ½è§„åˆ™æ¨è
   - å¼‚å¸¸åŒ…è£¹è‡ªåŠ¨è¯†åˆ«
   - æ ¼å£åˆ†é…ä¼˜åŒ–ç®—æ³•
4. **å›½é™…åŒ–** - æ”¯æŒå¤šè¯­è¨€ç•Œé¢
   - ä¸­æ–‡/è‹±æ–‡åˆ‡æ¢
   - æœ¬åœ°åŒ–èµ„æºç®¡ç†
5. **äº‘åŸç”Ÿ** - æ”¯æŒäº‘å¹³å°éƒ¨ç½²ï¼ˆAzure, AWS, é˜¿é‡Œäº‘ï¼‰
   - äº‘æ•°æ®åº“æ”¯æŒ
   - äº‘å­˜å‚¨é›†æˆ
   - å¼¹æ€§ä¼¸ç¼©
6. **å¤§æ•°æ®åˆ†æ** - åŸºäºæ—¥å¿—æ•°æ®çš„æ·±åº¦åˆ†æå’ŒæŠ¥è¡¨
   - åˆ†æ‹£æ•ˆç‡åˆ†æ
   - åŒ…è£¹æµå‘åˆ†æ
   - å¼‚å¸¸è¶‹åŠ¿åˆ†æ
   - è‡ªå®šä¹‰æŠ¥è¡¨ç”Ÿæˆ
7. **å®æ—¶æ•°æ®æµ** - ä½¿ç”¨Kafkaæˆ–å…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—å®ç°å®æ—¶æ•°æ®æµå¤„ç†
   - äº‹ä»¶æº¯æº
   - CQRSæ¨¡å¼
   - å®æ—¶æ•°æ®ç®¡é“

## æ€§èƒ½åŸºå‡†æµ‹è¯•

ç³»ç»ŸåŒ…å«å®Œæ•´çš„æ€§èƒ½åŸºå‡†æµ‹è¯•é¡¹ç›®ï¼ˆBenchmarkDotNetæ¡†æ¶ï¼‰ï¼š

### è¿è¡ŒåŸºå‡†æµ‹è¯•

```bash
cd ZakYip.Sorting.RuleEngine.Benchmarks
dotnet run -c Release
```

### å¯ç”¨åŸºå‡†æµ‹è¯•

1. **RuleMatchingBenchmarks** - è§„åˆ™åŒ¹é…æ€§èƒ½æµ‹è¯•
   - æ¡ç æ­£åˆ™åŒ¹é…ï¼ˆStartsWith, Contains, Regexï¼‰
   - é‡é‡åŒ¹é…ï¼ˆç®€å•ã€å¤æ‚è¡¨è¾¾å¼ï¼‰
   - ä½“ç§¯åŒ¹é…ï¼ˆç®€å•ã€å¤æ‚è¡¨è¾¾å¼ï¼‰

### åŸºå‡†æµ‹è¯•ç‰¹æ€§

- âœ… å†…å­˜è¯Šæ–­ - è·Ÿè¸ªå†…å­˜åˆ†é…
- âœ… æ€§èƒ½æ’å - è‡ªåŠ¨æ’åºæœ€å¿«åˆ°æœ€æ…¢
- âœ… ç»Ÿè®¡æ•°æ® - P50/P95/P99å»¶è¿Ÿ
- âœ… å¯æ‰©å±• - è½»æ¾æ·»åŠ æ–°çš„åŸºå‡†æµ‹è¯•

## æµ‹è¯•å·¥å…·ä½¿ç”¨

### è¿è¡Œæµ‹è¯•æ§åˆ¶å°

```bash
cd ZakYip.Sorting.RuleEngine.TestConsole
dotnet run
```

æµ‹è¯•æ§åˆ¶å°æä¾›ä¸¤ç§æ¨¡å¼ï¼š

**æ¨¡å¼1ï¼šæ¨¡æ‹Ÿåˆ†æ‹£æœºä¿¡å·**
- é€šè¿‡HTTP APIå‘é€åŒ…è£¹åˆ›å»ºä¿¡å·åˆ°ä¸»ç³»ç»Ÿ
- æµ‹è¯•åˆ†æ‹£æœºä¿¡å·æ¥æ”¶æµç¨‹

**æ¨¡å¼2ï¼šæ¨¡æ‹ŸDWSæ•°æ®**
- é€šè¿‡TCPå‘é€DWSæµ‹é‡æ•°æ®åˆ°ä¸»ç³»ç»Ÿ
- æµ‹è¯•DWSæ•°æ®æ¥æ”¶å’Œå¤„ç†æµç¨‹

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: https://github.com/Hisoka6602/ZakYip.Sorting.RuleEngine.Core
- é—®é¢˜åé¦ˆ: https://github.com/Hisoka6602/ZakYip.Sorting.RuleEngine.Core/issues

---

**æ³¨æ„**: 
- æœ¬ç³»ç»Ÿè®¾è®¡ç”¨äºé«˜é¢‘ç‡åœºæ™¯ï¼Œç¡®ä¿ç¡¬ä»¶èµ„æºå……è¶³ä»¥è·å¾—æœ€ä½³æ€§èƒ½ã€‚
- é¡¹ç›®å·²é‡å‘½åä¸º `ZakYip.Sorting.RuleEngine`ï¼ˆç§»é™¤äº† `.Core` åç¼€ï¼‰ã€‚
- æ•°æ®æ¸…ç†ç­–ç•¥å·²ä»å®šæ—¶æ”¹ä¸ºåŸºäºç©ºé—²æ£€æµ‹ï¼ˆé»˜è®¤30åˆ†é’Ÿæ— åŒ…è£¹åˆ›å»ºåè§¦å‘æ¸…ç†ï¼‰ã€‚
- æ–°å¢åˆ†ç‰‡è¡¨è‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†åŠŸèƒ½ã€‚